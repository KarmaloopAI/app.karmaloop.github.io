(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{39107:function(e,t,s){Promise.resolve().then(s.bind(s,53138))},53138:function(e,t,s){"use strict";s.d(t,{default:function(){return eT}});var a=s(14623),n=s(2265),l=s(59625),i=s(57557);let r="https://ixeqedgrusamxwsvwoho.supabase.co",c=(0,i.eI)(r,"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml4ZXFlZGdydXNhbXh3c3Z3b2hvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk3NDUwODcsImV4cCI6MjA2NTMyMTA4N30.tCb8nATBWRQrbhMXKT-omop5ZLNA954ObbGbQcKjxCc"),o=async function(e){var t;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=null===(t=(await c.auth.getSession()).data.session)||void 0===t?void 0:t.access_token,n={headers:{"Content-Type":"application/json",...a&&{Authorization:"Bearer ".concat(a)}}},l=await fetch("".concat(r,"/functions/v1/").concat(e),{...n,...s,headers:{...n.headers,...s.headers}});if(!l.ok)throw Error(await l.text());return l.json()},d=e=>{if(e.startsWith("+1")&&12===e.length){let t=e.slice(2);return"(".concat(t.slice(0,3),") ").concat(t.slice(3,6),"-").concat(t.slice(6))}return e},m=e=>"".concat(Math.floor(e/60),":").concat((e%60).toString().padStart(2,"0")),u=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(e),x=e=>{switch(e){case"success":return"text-success-600 bg-success-50";case"failure":case"error":return"text-error-600 bg-error-50";case"no_answer":case"busy":return"text-warning-600 bg-warning-50";case"voicemail":return"text-secondary-600 bg-secondary-50";case"in_progress":return"text-primary-600 bg-primary-50";default:return"text-neutral-600 bg-neutral-50"}},h=(0,l.Ue)((e,t)=>({user:null,profile:null,organization:null,subscription:null,loading:!0,agents:[],contacts:[],selectedAgent:null,setUser:t=>e({user:t}),setProfile:t=>e({profile:t}),setOrganization:t=>e({organization:t}),setSubscription:t=>e({subscription:t}),setLoading:t=>e({loading:t}),setAgents:t=>e({agents:t}),setContacts:t=>e({contacts:t}),setSelectedAgent:t=>e({selectedAgent:t}),fetchUserData:async()=>{try{console.log("\uD83D\uDD04 Starting fetchUserData...");let{data:{user:t},error:s}=await c.auth.getUser();if(s){console.error("❌ Error getting user:",s),e({user:null,profile:null,organization:null,subscription:null,loading:!1});return}if(!t){console.log("\uD83D\uDC64 No user found"),e({user:null,profile:null,organization:null,subscription:null,loading:!1});return}console.log("✅ User found:",t.email),e({user:t}),console.log("\uD83D\uDCCB Fetching user profile...");let{data:a,error:n}=await c.from("user_profiles").select("*").eq("id",t.id).single();if(n?(console.error("❌ Error fetching profile:",n),e({profile:null})):(console.log("✅ Profile found:",a),e({profile:a})),null==a?void 0:a.organization_id){console.log("\uD83C\uDFE2 Fetching organization...");let{data:t,error:s}=await c.from("organizations").select("*").eq("id",a.organization_id).single();s?console.error("❌ Error fetching organization:",s):(console.log("✅ Organization found:",t),e({organization:t})),console.log("\uD83D\uDCB3 Fetching subscription...");let{data:n,error:l}=await c.from("subscriptions").select("*").eq("organization_id",a.organization_id).single();l?console.error("❌ Error fetching subscription:",l):(console.log("✅ Subscription found:",n),e({subscription:n})),console.log("\uD83E\uDD16 Fetching agents for organization:",a.organization_id);let{data:i,error:r}=await c.from("agents").select("*").eq("organization_id",a.organization_id).order("created_at",{ascending:!1});r?(console.error("❌ Error fetching agents during user data fetch:",r),e({agents:[]})):(console.log("✅ Agents found during user data fetch:",{count:(null==i?void 0:i.length)||0,agents:null==i?void 0:i.map(e=>({id:e.id,name:e.name,phone_number:e.phone_number}))}),e({agents:i||[]}))}console.log("✅ fetchUserData completed, setting loading to false"),e({loading:!1})}catch(t){console.error("\uD83D\uDCA5 Error in fetchUserData:",t),e({loading:!1})}},fetchAgents:async()=>{try{let{profile:s,user:a}=t();if(console.log("\uD83E\uDD16 fetchAgents called:",{hasProfile:!!s,organizationId:null==s?void 0:s.organization_id,hasUser:!!a}),!(null==s?void 0:s.organization_id)){console.log("⚠️ No organization_id in profile, cannot fetch agents");return}console.log("\uD83D\uDCBE Querying agents table for org:",s.organization_id);let{data:n,error:l}=await c.from("agents").select("*").eq("organization_id",s.organization_id).order("created_at",{ascending:!1});if(l)throw console.error("❌ Error fetching agents:",l),l;return console.log("✅ Agents fetched successfully:",{count:(null==n?void 0:n.length)||0,agents:null==n?void 0:n.map(e=>({id:e.id,name:e.name,phone_number:e.phone_number}))}),e({agents:n||[]}),n||[]}catch(t){return console.error("\uD83D\uDCF4 Error fetching agents:",t),e({agents:[]}),[]}},fetchContacts:async()=>{try{let{profile:s}=t();if(!(null==s?void 0:s.organization_id))return;let{data:a}=await c.from("contacts").select("*").eq("organization_id",s.organization_id).order("created_at",{ascending:!1});e({contacts:a||[]})}catch(e){console.error("Error fetching contacts:",e)}},logout:async()=>{await c.auth.signOut(),e({user:null,profile:null,organization:null,subscription:null,agents:[],contacts:[],selectedAgent:null})}}));var p=s(60429),g=s(5095),j=s(15863),f=s(29090),b=s(89345),N=s(87769),y=s(42208),v=s(69064);function w(e){let{onSuccess:t,onSwitchToSignup:s,onForgotPassword:l}=e,[i,r]=(0,n.useState)({email:"",password:""}),[o,d]=(0,n.useState)(!1),[m,u]=(0,n.useState)(!1),[x,h]=(0,n.useState)({}),g=()=>{let e={};return i.email.trim()?/\S+@\S+\.\S+/.test(i.email)||(e.email="Please enter a valid email"):e.email="Email is required",i.password||(e.password="Password is required"),h(e),0===Object.keys(e).length},j=async e=>{if(e.preventDefault(),g()){u(!0);try{console.log("\uD83D\uDD10 Attempting login...");let{data:e,error:s}=await c.auth.signInWithPassword({email:i.email,password:i.password});if(s)throw console.error("❌ Login error:",s),s;e.user&&(console.log("✅ Login successful, user:",e.user.email),v.ZP.success("Welcome back!"),setTimeout(()=>{console.log("\uD83C\uDFAF Calling onSuccess callback"),t()},100))}catch(e){console.error("\uD83D\uDCA5 Login error:",e),e.message.includes("Invalid login credentials")?v.ZP.error("Invalid email or password"):e.message.includes("Email not confirmed")?v.ZP.error("Please check your email and click the verification link"):v.ZP.error(e.message||"Failed to sign in")}finally{setTimeout(()=>{u(!1)},500)}}},w=(e,t)=>{r(s=>({...s,[e]:t})),x[e]&&h(t=>({...t,[e]:void 0}))};return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-secondary-50 flex items-center justify-center p-4",children:(0,a.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-3xl shadow-strong p-8 w-full max-w-md",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)(p.E.div,{initial:{scale:.9},animate:{scale:1},className:"w-16 h-16 bg-primary-600 rounded-2xl flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(f.Z,{className:"w-8 h-8 text-white"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-neutral-900",children:"Welcome Back"}),(0,a.jsx)("p",{className:"text-neutral-600 mt-2",children:"Sign in to manage your AI voice agents"})]}),(0,a.jsxs)("form",{onSubmit:j,className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Email Address"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(b.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-neutral-400"}),(0,a.jsx)("input",{type:"email",value:i.email,onChange:e=>w("email",e.target.value),className:"input-field pl-10 ".concat(x.email?"border-error-500":""),placeholder:"john@example.com",autoComplete:"email",disabled:m})]}),x.email&&(0,a.jsx)("p",{className:"text-error-600 text-sm mt-1",children:x.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Password"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:o?"text":"password",value:i.password,onChange:e=>w("password",e.target.value),className:"input-field pr-10 ".concat(x.password?"border-error-500":""),placeholder:"••••••••",autoComplete:"current-password",disabled:m}),(0,a.jsx)("button",{type:"button",onClick:()=>d(!o),className:"absolute right-3 top-1/2 transform -translate-y-1/2",disabled:m,children:o?(0,a.jsx)(N.Z,{className:"w-5 h-5 text-neutral-400"}):(0,a.jsx)(y.Z,{className:"w-5 h-5 text-neutral-400"})})]}),x.password&&(0,a.jsx)("p",{className:"text-error-600 text-sm mt-1",children:x.password})]}),(0,a.jsx)("div",{className:"text-right",children:(0,a.jsx)("button",{type:"button",onClick:l,className:"text-sm text-primary-600 hover:text-primary-700 font-medium",disabled:m,children:"Forgot your password?"})}),(0,a.jsx)("button",{type:"submit",disabled:m,className:"w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:m?"Signing in...":"Sign In"})]}),(0,a.jsx)("div",{className:"text-center mt-6",children:(0,a.jsxs)("p",{className:"text-neutral-600",children:["Don't have an account?"," ",(0,a.jsx)("button",{onClick:s,className:"text-primary-600 hover:text-primary-700 font-medium",disabled:m,children:"Create one"})]})}),(0,a.jsxs)(p.E.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"mt-6 p-4 bg-primary-50 rounded-xl border border-primary-200",children:[(0,a.jsx)("h3",{className:"font-medium text-primary-800 mb-1",children:"Start Your Free Trial"}),(0,a.jsx)("p",{className:"text-sm text-primary-700",children:"Get 14 days and 100 minutes free to test Kai's AI voice agents"})]})]})})}var C=s(92369),D=s(13041),_=s(60044);function k(e){let{onSuccess:t,onSwitchToLogin:s}=e,[l,i]=(0,n.useState)({firstName:"",lastName:"",email:"",password:"",confirmPassword:"",phoneNumber:"",organizationName:"",industry:""}),[r,o]=(0,n.useState)(!1),[d,m]=(0,n.useState)(!1),[u,x]=(0,n.useState)(!1),[h,g]=(0,n.useState)(1),[j,f]=(0,n.useState)({}),w=()=>{let e={};return l.firstName.trim()||(e.firstName="First name is required"),l.lastName.trim()||(e.lastName="Last name is required"),l.email.trim()?/\S+@\S+\.\S+/.test(l.email)||(e.email="Please enter a valid email"):e.email="Email is required",l.password?l.password.length<6&&(e.password="Password must be at least 6 characters"):e.password="Password is required",l.password!==l.confirmPassword&&(e.confirmPassword="Passwords do not match"),l.phoneNumber.trim()?/^\+?[\d\s\-\(\)]+$/.test(l.phoneNumber)||(e.phoneNumber="Please enter a valid phone number"):e.phoneNumber="Phone number is required",f(e),0===Object.keys(e).length},k=()=>{let e={};return l.organizationName.trim()||(e.organizationName="Organization name is required"),l.industry.trim()||(e.industry="Industry is required"),f(e),0===Object.keys(e).length},S=()=>{w()&&g(2)},A=async e=>{if(e.preventDefault(),k()){x(!0);try{let e=l.phoneNumber.replace(/\D/g,"");10===e.length?e="+1".concat(e):11===e.length&&e.startsWith("1")?e="+".concat(e):e.startsWith("+")||(e="+1".concat(e));let{data:s,error:a}=await c.auth.signUp({email:l.email,password:l.password,options:{data:{first_name:l.firstName,last_name:l.lastName,phone_number:e,organization_name:l.organizationName,industry:l.industry},emailRedirectTo:"".concat(window.location.origin,"/auth/callback")}});if(a)throw a;if(s.user){console.log("✅ User created successfully:",s.user.email),console.log("\uD83C\uDFE2 Creating organization...");let{data:a,error:n}=await c.from("organizations").insert({name:l.organizationName,industry:l.industry,default_country_code:"+1"}).select().single();if(n)throw console.error("❌ Organization creation error:",n),n;console.log("✅ Organization created:",a),console.log("\uD83D\uDCCB Updating user profile...");let{error:i}=await c.from("user_profiles").update({organization_id:a.id,phone_number:e,email_verified:!1}).eq("id",s.user.id);if(i)throw console.error("❌ Profile update error:",i),i;console.log("✅ Profile updated successfully"),console.log("\uD83D\uDCB3 Creating subscription...");let{error:r}=await c.from("subscriptions").insert({organization_id:a.id,status:"trial",minutes_included:100,minutes_used:0});if(r)throw console.error("❌ Subscription creation error:",r),r;console.log("✅ Subscription created successfully"),v.ZP.success("Account created successfully! Please check your email for verification."),t()}}catch(e){console.error("Signup error:",e),v.ZP.error(e.message||"Failed to create account")}finally{x(!1)}}},Z=(e,t)=>{i(s=>({...s,[e]:t})),j[e]&&f(t=>({...t,[e]:void 0}))};return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-secondary-50 flex items-center justify-center p-4",children:(0,a.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-3xl shadow-strong p-8 w-full max-w-md",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)(p.E.div,{initial:{scale:.9},animate:{scale:1},className:"w-16 h-16 bg-primary-600 rounded-2xl flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(C.Z,{className:"w-8 h-8 text-white"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-neutral-900",children:"Create Your Account"}),(0,a.jsx)("p",{className:"text-neutral-600 mt-2",children:"Join the AI voice agent revolution"}),!1]}),(0,a.jsx)("div",{className:"flex items-center justify-center mb-8",children:(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ".concat(h>=1?"bg-primary-600 text-white":"bg-neutral-200 text-neutral-500"),children:"1"}),(0,a.jsx)("div",{className:"w-16 h-1 rounded ".concat(h>=2?"bg-primary-600":"bg-neutral-200")}),(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ".concat(h>=2?"bg-primary-600 text-white":"bg-neutral-200 text-neutral-500"),children:"2"})]})}),(0,a.jsx)("form",{onSubmit:1===h?e=>{e.preventDefault(),S()}:A,children:1===h?(0,a.jsxs)(p.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-6",children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-center text-neutral-900",children:"Personal Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"First Name"}),(0,a.jsx)("input",{type:"text",value:l.firstName,onChange:e=>Z("firstName",e.target.value),className:"input-field ".concat(j.firstName?"border-error-500":""),placeholder:"John"}),j.firstName&&(0,a.jsx)("p",{className:"text-error-600 text-sm mt-1",children:j.firstName})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Last Name"}),(0,a.jsx)("input",{type:"text",value:l.lastName,onChange:e=>Z("lastName",e.target.value),className:"input-field ".concat(j.lastName?"border-error-500":""),placeholder:"Doe"}),j.lastName&&(0,a.jsx)("p",{className:"text-error-600 text-sm mt-1",children:j.lastName})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Email Address"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(b.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-neutral-400"}),(0,a.jsx)("input",{type:"email",value:l.email,onChange:e=>Z("email",e.target.value),className:"input-field pl-10 ".concat(j.email?"border-error-500":""),placeholder:"john@example.com"})]}),j.email&&(0,a.jsx)("p",{className:"text-error-600 text-sm mt-1",children:j.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Phone Number"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(D.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-neutral-400"}),(0,a.jsx)("input",{type:"tel",value:l.phoneNumber,onChange:e=>Z("phoneNumber",e.target.value),className:"input-field pl-10 ".concat(j.phoneNumber?"border-error-500":""),placeholder:"+1 (555) 123-4567"})]}),j.phoneNumber&&(0,a.jsx)("p",{className:"text-error-600 text-sm mt-1",children:j.phoneNumber})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Password"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:r?"text":"password",value:l.password,onChange:e=>Z("password",e.target.value),className:"input-field pr-10 ".concat(j.password?"border-error-500":""),placeholder:"••••••••"}),(0,a.jsx)("button",{type:"button",onClick:()=>o(!r),className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:r?(0,a.jsx)(N.Z,{className:"w-5 h-5 text-neutral-400"}):(0,a.jsx)(y.Z,{className:"w-5 h-5 text-neutral-400"})})]}),j.password&&(0,a.jsx)("p",{className:"text-error-600 text-sm mt-1",children:j.password})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Confirm Password"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:d?"text":"password",value:l.confirmPassword,onChange:e=>Z("confirmPassword",e.target.value),className:"input-field pr-10 ".concat(j.confirmPassword?"border-error-500":""),placeholder:"••••••••"}),(0,a.jsx)("button",{type:"button",onClick:()=>m(!d),className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:d?(0,a.jsx)(N.Z,{className:"w-5 h-5 text-neutral-400"}):(0,a.jsx)(y.Z,{className:"w-5 h-5 text-neutral-400"})})]}),j.confirmPassword&&(0,a.jsx)("p",{className:"text-error-600 text-sm mt-1",children:j.confirmPassword})]}),(0,a.jsx)("button",{type:"submit",className:"w-full btn-primary",children:"Continue to Organization"})]}):(0,a.jsxs)(p.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-6",children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-center text-neutral-900",children:"Organization Details"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Organization Name"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(_.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-neutral-400"}),(0,a.jsx)("input",{type:"text",value:l.organizationName,onChange:e=>Z("organizationName",e.target.value),className:"input-field pl-10 ".concat(j.organizationName?"border-error-500":""),placeholder:"Acme Corporation"})]}),j.organizationName&&(0,a.jsx)("p",{className:"text-error-600 text-sm mt-1",children:j.organizationName})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Industry"}),(0,a.jsxs)("select",{value:l.industry,onChange:e=>Z("industry",e.target.value),className:"input-field ".concat(j.industry?"border-error-500":""),children:[(0,a.jsx)("option",{value:"",children:"Select your industry"}),(0,a.jsx)("option",{value:"Technology",children:"Technology"}),(0,a.jsx)("option",{value:"Healthcare",children:"Healthcare"}),(0,a.jsx)("option",{value:"Finance",children:"Finance"}),(0,a.jsx)("option",{value:"Retail",children:"Retail"}),(0,a.jsx)("option",{value:"Real Estate",children:"Real Estate"}),(0,a.jsx)("option",{value:"Education",children:"Education"}),(0,a.jsx)("option",{value:"Manufacturing",children:"Manufacturing"}),(0,a.jsx)("option",{value:"Hospitality",children:"Hospitality"}),(0,a.jsx)("option",{value:"Marketing",children:"Marketing"}),(0,a.jsx)("option",{value:"Consulting",children:"Consulting"}),(0,a.jsx)("option",{value:"Other",children:"Other"})]}),j.industry&&(0,a.jsx)("p",{className:"text-error-600 text-sm mt-1",children:j.industry})]}),(0,a.jsxs)("div",{className:"flex space-x-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>g(1),className:"flex-1 btn-secondary",children:"Back"}),(0,a.jsx)("button",{type:"submit",disabled:u,className:"flex-1 btn-primary",children:u?"Creating Account...":"Create Account"})]})]})}),(0,a.jsx)("div",{className:"text-center mt-6",children:(0,a.jsxs)("p",{className:"text-neutral-600",children:["Already have an account?"," ",(0,a.jsx)("button",{onClick:s,className:"text-primary-600 hover:text-primary-700 font-medium",children:"Sign in"})]})})]})})}var S=s(65302),A=s(32660);function Z(e){let{onBack:t}=e,[s,l]=(0,n.useState)(""),[i,r]=(0,n.useState)(!1),[o,d]=(0,n.useState)(!1),[m,u]=(0,n.useState)(""),x=e=>/\S+@\S+\.\S+/.test(e),h=async e=>{if(e.preventDefault(),!s.trim()){u("Email is required");return}if(!x(s)){u("Please enter a valid email address");return}r(!0),u("");try{let{error:e}=await c.auth.resetPasswordForEmail(s,{redirectTo:"".concat(window.location.origin,"/auth/reset-password")});if(e)throw e;d(!0),v.ZP.success("Password reset email sent!")}catch(e){console.error("Password reset error:",e),e.message.includes("rate limit")?u("Too many requests. Please wait a moment before trying again."):u(e.message||"Failed to send password reset email")}finally{r(!1)}},g=e=>{l(e),u("")};return o?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-secondary-50 flex items-center justify-center p-4",children:(0,a.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-3xl shadow-strong p-8 w-full max-w-md text-center",children:[(0,a.jsx)(p.E.div,{initial:{scale:.9},animate:{scale:1},className:"w-16 h-16 bg-success-600 rounded-2xl flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(S.Z,{className:"w-8 h-8 text-white"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-neutral-900 mb-2",children:"Check Your Email"}),(0,a.jsx)("p",{className:"text-neutral-600 mb-4",children:"We've sent a password reset link to:"}),(0,a.jsx)("p",{className:"font-medium text-neutral-900 mb-6",children:s}),(0,a.jsxs)("div",{className:"bg-neutral-50 rounded-xl p-4 mb-6 text-left",children:[(0,a.jsx)("h3",{className:"font-medium text-neutral-800 mb-2",children:"Next Steps:"}),(0,a.jsxs)("ol",{className:"text-sm text-neutral-600 space-y-1",children:[(0,a.jsx)("li",{children:"1. Check your email inbox"}),(0,a.jsx)("li",{children:"2. Click the reset password link"}),(0,a.jsx)("li",{children:"3. Create a new password"}),(0,a.jsx)("li",{children:"4. Sign in with your new password"})]})]}),(0,a.jsx)("button",{onClick:t,className:"w-full btn-primary",children:"Back to Sign In"}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsxs)("p",{className:"text-sm text-neutral-600",children:["Didn't receive the email? Check your spam folder or"," ",(0,a.jsx)("button",{onClick:()=>{d(!1),l("")},className:"text-primary-600 hover:text-primary-700 font-medium",children:"try again"})]})})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-secondary-50 flex items-center justify-center p-4",children:(0,a.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-3xl shadow-strong p-8 w-full max-w-md",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)(p.E.div,{initial:{scale:.9},animate:{scale:1},className:"w-16 h-16 bg-warning-600 rounded-2xl flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(b.Z,{className:"w-8 h-8 text-white"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-neutral-900",children:"Reset Your Password"}),(0,a.jsx)("p",{className:"text-neutral-600 mt-2",children:"Enter your email address and we'll send you a link to reset your password"})]}),(0,a.jsxs)("form",{onSubmit:h,className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Email Address"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(b.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-neutral-400"}),(0,a.jsx)("input",{type:"email",value:s,onChange:e=>g(e.target.value),className:"input-field pl-10 ".concat(m?"border-error-500":""),placeholder:"john@example.com",autoComplete:"email"})]}),m&&(0,a.jsx)(p.E.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-error-600 text-sm mt-1",children:m})]}),(0,a.jsx)("button",{type:"submit",disabled:i,className:"w-full btn-primary",children:i?"Sending Reset Link...":"Send Reset Link"})]}),(0,a.jsx)("div",{className:"text-center mt-6",children:(0,a.jsxs)("button",{onClick:t,className:"flex items-center justify-center text-neutral-600 hover:text-neutral-700 mx-auto",children:[(0,a.jsx)(A.Z,{className:"w-4 h-4 mr-1"}),"Back to Sign In"]})}),(0,a.jsxs)(p.E.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"mt-6 p-4 bg-neutral-50 rounded-xl",children:[(0,a.jsx)("h3",{className:"font-medium text-neutral-800 mb-1",children:"Security Note"}),(0,a.jsx)("p",{className:"text-sm text-neutral-600",children:"For your security, the password reset link will expire in 1 hour. If you don't see the email, check your spam folder."})]})]})})}var E=s(82431),P=s(30401);function z(e){let{type:t,contact:s,onSuccess:l,onBack:i}=e,[r,c]=(0,n.useState)(""),[d,m]=(0,n.useState)(!1),[u,x]=(0,n.useState)(!1),[h,g]=(0,n.useState)(0),[j,f]=(0,n.useState)("");(0,n.useEffect)(()=>{N()},[]),(0,n.useEffect)(()=>{if(h>0){let e=setTimeout(()=>g(h-1),1e3);return()=>clearTimeout(e)}},[h]);let N=async()=>{try{x(!0),f(""),await o("twilio-verify",{method:"POST",body:JSON.stringify({action:"send",type:t,contact:s})}),v.ZP.success("Verification code sent to your ".concat(t)),g(60)}catch(e){console.error("Error sending verification code:",e),v.ZP.error("Failed to send verification code: ".concat(e.message)),f(e.message)}finally{x(!1)}},y=async()=>{if(6!==r.length){f("Please enter a 6-digit code");return}try{m(!0),f(""),(await o("twilio-verify",{method:"POST",body:JSON.stringify({action:"verify",type:t,contact:s,code:r})})).verified?(v.ZP.success("".concat(t," verified successfully!")),l()):f("Invalid verification code")}catch(e){console.error("Error verifying code:",e),f(e.message||"Verification failed")}finally{m(!1)}},w=e=>{let t=e.replace(/\D/g,"").slice(0,6);c(t),f(""),6===t.length&&setTimeout(()=>y(),100)};return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-secondary-50 flex items-center justify-center p-4",children:(0,a.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-3xl shadow-strong p-8 w-full max-w-md",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)(p.E.div,{initial:{scale:.9},animate:{scale:1},className:"w-16 h-16 bg-primary-600 rounded-2xl flex items-center justify-center mx-auto mb-4",children:"phone"===t?(0,a.jsx)(D.Z,{className:"w-8 h-8 text-white"}):(0,a.jsx)(b.Z,{className:"w-8 h-8 text-white"})}),(0,a.jsxs)("h1",{className:"text-2xl font-bold text-neutral-900",children:["Verify Your ","phone"===t?"Phone Number":"Email"]}),(0,a.jsx)("p",{className:"text-neutral-600 mt-2",children:"We've sent a 6-digit code to"}),(0,a.jsx)("p",{className:"font-medium text-neutral-900 mt-1",children:s})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-4 text-center",children:"Enter Verification Code"}),(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)("input",{type:"text",value:r,onChange:e=>w(e.target.value),className:"text-center text-2xl font-mono tracking-widest w-48 py-4 border-2 rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200 ".concat(j?"border-error-500":"border-neutral-300"),placeholder:"123456",maxLength:6,autoComplete:"one-time-code"})}),j&&(0,a.jsx)(p.E.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-error-600 text-sm mt-2 text-center",children:j})]}),(0,a.jsx)("button",{onClick:y,disabled:d||6!==r.length,className:"w-full btn-primary mb-4 disabled:opacity-50 disabled:cursor-not-allowed",children:d?(0,a.jsxs)("div",{className:"flex items-center justify-center",children:[(0,a.jsx)(E.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"Verifying..."]}):(0,a.jsxs)("div",{className:"flex items-center justify-center",children:[(0,a.jsx)(P.Z,{className:"w-4 h-4 mr-2"}),"Verify Code"]})}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-neutral-600 text-sm mb-2",children:"Didn't receive the code?"}),(0,a.jsx)("button",{onClick:N,disabled:u||h>0,className:"text-primary-600 hover:text-primary-700 font-medium text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:u?(0,a.jsxs)("div",{className:"flex items-center justify-center",children:[(0,a.jsx)(E.Z,{className:"w-4 h-4 mr-1 animate-spin"}),"Sending..."]}):h>0?"Resend in ".concat(h,"s"):"Resend Code"})]}),i&&(0,a.jsx)("div",{className:"text-center mt-6",children:(0,a.jsx)("button",{onClick:i,className:"text-neutral-600 hover:text-neutral-700 text-sm",children:"← Back"})}),(0,a.jsxs)(p.E.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"mt-6 p-4 bg-neutral-50 rounded-xl",children:[(0,a.jsx)("h3",{className:"font-medium text-neutral-800 mb-1",children:"Having trouble?"}),(0,a.jsx)("p",{className:"text-sm text-neutral-600",children:"phone"===t?"Make sure your phone can receive SMS messages and check your spam folder.":"Check your email inbox and spam folder for the verification code."}),(0,a.jsxs)("p",{className:"text-sm text-neutral-600 mt-2",children:["Contact us at"," ",(0,a.jsx)("a",{href:"mailto:contact@karmaloop.ai",className:"text-primary-600 hover:text-primary-700",children:"contact@karmaloop.ai"})," ","if you need help."]})]})]})})}function I(e){let{onAuthSuccess:t}=e,[s,l]=(0,n.useState)("login"),[i,r]=(0,n.useState)(""),{fetchUserData:c}=h(),o=async()=>{console.log("\uD83D\uDE80 AuthWrapper handleAuthSuccess called");try{await c(),console.log("✅ AuthWrapper fetchUserData completed"),t()}catch(e){console.error("❌ AuthWrapper fetchUserData failed:",e),t()}},d=()=>{l("login")},m=()=>{o()};return(()=>{switch(s){case"login":default:return(0,a.jsx)(w,{onSuccess:o,onSwitchToSignup:()=>l("signup"),onForgotPassword:()=>l("forgot-password")});case"signup":return(0,a.jsx)(k,{onSuccess:d,onSwitchToLogin:()=>l("login")});case"forgot-password":return(0,a.jsx)(Z,{onBack:()=>l("login")});case"verify-phone":return(0,a.jsx)(z,{type:"phone",contact:i,onSuccess:m,onBack:()=>l("login")});case"verify-email":return(0,a.jsx)(z,{type:"email",contact:i,onSuccess:m,onBack:()=>l("login")})}})()}var T=s(82222),O=s(95805),F=s(46221),M=s(53417),R=s(82023),q=s(76858),U=s(11239);function L(e){let{onGetStarted:t}=e,s=[{icon:T.Z,title:"AI Voice Agents",description:"Create intelligent voice agents that can handle sales calls and customer support 24/7"},{icon:D.Z,title:"Outbound & Inbound",description:"Handle incoming customer calls and make outbound sales calls automatically"},{icon:O.Z,title:"CRM Integration",description:"Automatically log calls, update customer records, and track interactions"},{icon:F.Z,title:"Analytics & Reports",description:"Get insights into call performance, success rates, and customer interactions"}],n=[{number:1,title:"Configure Your Agent",description:"Set up your business objective, target audience, and voice preferences"},{number:2,title:"Get Your Phone Number",description:"Acquire a dedicated phone number for your AI voice agent"},{number:3,title:"Go Live",description:"Your agent starts handling calls immediately"}];return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 via-white to-secondary-50",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-12",children:[(0,a.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center mb-16",children:[(0,a.jsx)(p.E.div,{initial:{scale:.9},animate:{scale:1},transition:{delay:.1},className:"w-20 h-20 bg-primary-600 rounded-3xl flex items-center justify-center mx-auto mb-6",children:(0,a.jsx)(M.Z,{className:"w-10 h-10 text-white"})}),(0,a.jsxs)(p.E.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"text-4xl md:text-5xl font-bold text-neutral-900 mb-4",children:["Welcome to"," ",(0,a.jsx)("span",{className:"bg-gradient-to-r from-primary-600 to-secondary-600 bg-clip-text text-transparent",children:"Kai Agent"})]}),(0,a.jsx)(p.E.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"text-xl text-neutral-600 mb-8 max-w-2xl mx-auto",children:"Transform your business with AI voice agents that handle sales calls and customer support with the intelligence and personality of your best team members."}),(0,a.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"flex items-center justify-center space-x-2 mb-8",children:[(0,a.jsx)(R.Z,{className:"w-5 h-5 text-warning-500"}),(0,a.jsx)("span",{className:"text-sm font-medium text-neutral-700",children:"14-day free trial • 100 minutes included • No credit card required"})]}),(0,a.jsxs)(p.E.button,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},onClick:e=>{e.preventDefault(),console.log("\uD83D\uDE80 Set Up First Agent clicked"),t()},type:"button",className:"btn-primary text-lg px-8 py-4 group",children:["Set Up Your First Agent",(0,a.jsx)(q.Z,{className:"w-5 h-5 ml-2 group-hover:translate-x-1 transition-transform"})]})]}),(0,a.jsx)(p.E.div,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},transition:{delay:.6},className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-16",children:s.map((e,t)=>{let s=e.icon;return(0,a.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7+.1*t},className:"card text-center",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-primary-100 rounded-xl flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(s,{className:"w-6 h-6 text-primary-600"})}),(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 mb-2",children:e.title}),(0,a.jsx)("p",{className:"text-neutral-600 text-sm",children:e.description})]},e.title)})}),(0,a.jsxs)(p.E.div,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},transition:{delay:.8},className:"text-center mb-16",children:[(0,a.jsx)("h2",{className:"text-3xl font-bold text-neutral-900 mb-4",children:"Get Started in 3 Simple Steps"}),(0,a.jsx)("p",{className:"text-neutral-600 mb-12 max-w-2xl mx-auto",children:"Setting up your AI voice agent is quick and easy. You'll be handling calls in minutes."}),(0,a.jsx)("div",{className:"grid md:grid-cols-3 gap-8",children:n.map((e,t)=>(0,a.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9+.1*t},className:"relative",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-primary-600 rounded-2xl flex items-center justify-center mx-auto mb-6",children:(0,a.jsx)("span",{className:"text-2xl font-bold text-white",children:e.number})}),(0,a.jsx)("h3",{className:"text-xl font-bold text-neutral-900 mb-3",children:e.title}),(0,a.jsx)("p",{className:"text-neutral-600",children:e.description}),t<n.length-1&&(0,a.jsx)("div",{className:"hidden md:block absolute top-8 left-full w-full h-0.5 bg-gradient-to-r from-primary-300 to-transparent -translate-x-8"})]},e.number))})]}),(0,a.jsx)(p.E.div,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},transition:{delay:1},className:"card bg-gradient-to-r from-primary-600 to-secondary-600 text-white text-center",children:(0,a.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,a.jsx)(U.Z,{className:"w-12 h-12 mx-auto mb-6 text-warning-300"}),(0,a.jsx)("h2",{className:"text-3xl font-bold mb-4",children:"Why Choose Kai Agent?"}),(0,a.jsx)("p",{className:"text-primary-100 mb-8 text-lg",children:"Our AI voice agents are trained specifically for sales and customer support, with British charm and intelligence that converts prospects into customers."}),(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-6 text-left",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)(S.Z,{className:"w-6 h-6 text-success-300 mt-1 flex-shrink-0"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium mb-1",children:"24/7 Availability"}),(0,a.jsx)("p",{className:"text-primary-100 text-sm",children:"Never miss a call or opportunity"})]})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)(S.Z,{className:"w-6 h-6 text-success-300 mt-1 flex-shrink-0"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium mb-1",children:"Instant Responses"}),(0,a.jsx)("p",{className:"text-primary-100 text-sm",children:"No wait times for customers"})]})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)(S.Z,{className:"w-6 h-6 text-success-300 mt-1 flex-shrink-0"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium mb-1",children:"Cost Effective"}),(0,a.jsx)("p",{className:"text-primary-100 text-sm",children:"Fraction of hiring a sales team"})]})]})]})]})})]})})}var B=s(58896),V=s(25846),J=s(81706),W=s(15001);function Y(e){let{onComplete:t,onBack:s}=e,[l,i]=(0,n.useState)(1),[r,c]=(0,n.useState)(!1),[d,m]=(0,n.useState)({name:"",description:"",voiceId:"Savannah",businessObjective:"",targetAudience:"",keyPainPoints:"",valuePropositon:"",callToAction:""}),[u,x]=(0,n.useState)({}),h=[{id:1,title:"Agent Identity",description:"Give your agent a name and personality",icon:T.Z},{id:2,title:"Business Setup",description:"Define your business objective and audience",icon:B.Z},{id:3,title:"Value Proposition",description:"Explain what makes you unique",icon:V.Z},{id:4,title:"Voice & Launch",description:"Choose voice and get your phone number",icon:J.Z}],j=e=>{let t={};switch(e){case 1:d.name.trim()||(t.name="Agent name is required");break;case 2:d.businessObjective.trim()||(t.businessObjective="Business objective is required"),d.targetAudience.trim()||(t.targetAudience="Target audience is required");break;case 3:d.keyPainPoints.trim()||(t.keyPainPoints="Key pain points are required"),d.valuePropositon.trim()||(t.valuePropositon="Value proposition is required"),d.callToAction.trim()||(t.callToAction="Call to action is required")}return x(t),0===Object.keys(t).length},f=async()=>{if(j(3)){c(!0);try{let e=(await o("acquire-phone-number",{method:"POST",body:JSON.stringify({action:"search"})})).availableNumbers;if(!e||0===e.length)throw Error("No phone numbers available");let s=await o("acquire-phone-number",{method:"POST",body:JSON.stringify({action:"purchase",phoneNumberSid:e[0].phoneNumber})});await o("create-agent",{method:"POST",body:JSON.stringify({name:d.name,description:d.description,voiceId:d.voiceId,businessObjective:d.businessObjective,targetAudience:d.targetAudience,keyPainPoints:d.keyPainPoints,valuePropositon:d.valuePropositon,callToAction:d.callToAction,phoneNumberId:s.phoneNumber.id})}),v.ZP.success("Your AI voice agent is now live!"),t()}catch(e){console.error("Error creating agent:",e),v.ZP.error(e.message||"Failed to create agent")}finally{c(!1)}}},b=(e,t)=>{m(s=>({...s,[e]:t})),u[e]&&x(t=>({...t,[e]:void 0}))};return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-secondary-50 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-3xl shadow-strong p-8 w-full max-w-2xl",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h1",{className:"text-xl font-bold text-neutral-900",children:"Set Up Your AI Agent"}),(0,a.jsxs)("span",{className:"text-sm text-neutral-500",children:["Step ",l," of ",4]})]}),(0,a.jsx)("div",{className:"flex items-center space-x-2",children:h.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center flex-1",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ".concat(l>=e.id?"bg-primary-600 text-white":"bg-neutral-200 text-neutral-500"),children:l>e.id?(0,a.jsx)(S.Z,{className:"w-5 h-5"}):e.id}),t<h.length-1&&(0,a.jsx)("div",{className:"flex-1 h-1 mx-2 rounded ".concat(l>e.id?"bg-primary-600":"bg-neutral-200")})]},e.id))})]}),(0,a.jsx)(g.M,{mode:"wait",children:(()=>{switch(l){case 1:return(0,a.jsxs)(p.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-primary-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(T.Z,{className:"w-8 h-8 text-primary-600"})}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-neutral-900 mb-2",children:"Meet Your AI Agent"}),(0,a.jsx)("p",{className:"text-neutral-600",children:"Give your agent a name and describe what it does"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Agent Name"}),(0,a.jsx)("input",{type:"text",value:d.name,onChange:e=>b("name",e.target.value),className:"input-field ".concat(u.name?"border-error-500":""),placeholder:"e.g., Sarah - Sales Assistant"}),u.name&&(0,a.jsx)("p",{className:"text-error-600 text-sm mt-1",children:u.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Description (Optional)"}),(0,a.jsx)("textarea",{value:d.description,onChange:e=>b("description",e.target.value),className:"input-field resize-none",rows:3,placeholder:"Brief description of what this agent will do..."})]})]},"step1");case 2:return(0,a.jsxs)(p.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-primary-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(B.Z,{className:"w-8 h-8 text-primary-600"})}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-neutral-900 mb-2",children:"Business Objectives"}),(0,a.jsx)("p",{className:"text-neutral-600",children:"Help us understand your business goals and audience"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"What is your main business objective?"}),(0,a.jsx)("textarea",{value:d.businessObjective,onChange:e=>b("businessObjective",e.target.value),className:"input-field resize-none ".concat(u.businessObjective?"border-error-500":""),rows:3,placeholder:"e.g., Generate qualified leads for our software consultancy services..."}),u.businessObjective&&(0,a.jsx)("p",{className:"text-error-600 text-sm mt-1",children:u.businessObjective})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Who is your target audience?"}),(0,a.jsx)("textarea",{value:d.targetAudience,onChange:e=>b("targetAudience",e.target.value),className:"input-field resize-none ".concat(u.targetAudience?"border-error-500":""),rows:3,placeholder:"e.g., CTOs and technical leaders at mid-size companies looking to modernize their systems..."}),u.targetAudience&&(0,a.jsx)("p",{className:"text-error-600 text-sm mt-1",children:u.targetAudience})]})]},"step2");case 3:return(0,a.jsxs)(p.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-primary-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(V.Z,{className:"w-8 h-8 text-primary-600"})}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-neutral-900 mb-2",children:"Value Proposition"}),(0,a.jsx)("p",{className:"text-neutral-600",children:"Define what makes you unique and compelling"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"What key pain points do you solve?"}),(0,a.jsx)("textarea",{value:d.keyPainPoints,onChange:e=>b("keyPainPoints",e.target.value),className:"input-field resize-none ".concat(u.keyPainPoints?"border-error-500":""),rows:3,placeholder:"e.g., Outdated systems slowing down operations, high technical debt, lack of automation..."}),u.keyPainPoints&&(0,a.jsx)("p",{className:"text-error-600 text-sm mt-1",children:u.keyPainPoints})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"What's your unique value proposition?"}),(0,a.jsx)("textarea",{value:d.valuePropositon,onChange:e=>b("valuePropositon",e.target.value),className:"input-field resize-none ".concat(u.valuePropositon?"border-error-500":""),rows:3,placeholder:"e.g., We deliver modern, scalable solutions 3x faster than traditional agencies with guaranteed ROI..."}),u.valuePropositon&&(0,a.jsx)("p",{className:"text-error-600 text-sm mt-1",children:u.valuePropositon})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"What action do you want prospects to take?"}),(0,a.jsx)("textarea",{value:d.callToAction,onChange:e=>b("callToAction",e.target.value),className:"input-field resize-none ".concat(u.callToAction?"border-error-500":""),rows:3,placeholder:"e.g., Schedule a free 30-minute technical assessment call to discuss their specific needs..."}),u.callToAction&&(0,a.jsx)("p",{className:"text-error-600 text-sm mt-1",children:u.callToAction})]})]},"step3");case 4:return(0,a.jsxs)(p.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-primary-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(J.Z,{className:"w-8 h-8 text-primary-600"})}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-neutral-900 mb-2",children:"Voice & Launch"}),(0,a.jsx)("p",{className:"text-neutral-600",children:"Choose your agent's voice and we'll get you a phone number"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-4",children:"Choose Voice"}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>b("voiceId","Savannah"),className:"p-6 rounded-xl border-2 transition-all duration-200 text-left ".concat("Savannah"===d.voiceId?"border-primary-500 bg-primary-50":"border-neutral-200 hover:border-neutral-300"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("h3",{className:"font-medium text-neutral-900",children:"Sandra"}),(0,a.jsx)("div",{className:"w-4 h-4 rounded-full border-2 ".concat("Savannah"===d.voiceId?"border-primary-500 bg-primary-500":"border-neutral-300")})]}),(0,a.jsx)("p",{className:"text-sm text-neutral-600 mb-3",children:"Professional, warm, and confident voice perfect for sales and customer service"}),(0,a.jsxs)("div",{className:"flex items-center text-xs text-neutral-500",children:[(0,a.jsx)(J.Z,{className:"w-3 h-3 mr-1"}),"British accent, friendly tone"]})]}),(0,a.jsxs)("button",{type:"button",onClick:()=>b("voiceId","Elliot"),className:"p-6 rounded-xl border-2 transition-all duration-200 text-left ".concat("Elliot"===d.voiceId?"border-primary-500 bg-primary-50":"border-neutral-200 hover:border-neutral-300"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("h3",{className:"font-medium text-neutral-900",children:"Jackson"}),(0,a.jsx)("div",{className:"w-4 h-4 rounded-full border-2 ".concat("Elliot"===d.voiceId?"border-primary-500 bg-primary-500":"border-neutral-300")})]}),(0,a.jsx)("p",{className:"text-sm text-neutral-600 mb-3",children:"Authoritative and trustworthy voice ideal for technical and business discussions"}),(0,a.jsxs)("div",{className:"flex items-center text-xs text-neutral-500",children:[(0,a.jsx)(J.Z,{className:"w-3 h-3 mr-1"}),"British accent, professional tone"]})]})]}),(0,a.jsx)("p",{className:"text-xs text-neutral-500 mt-2 text-center",children:"More voice options coming soon!"})]}),(0,a.jsx)("div",{className:"bg-primary-50 rounded-xl p-6 border border-primary-200",children:(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)(D.Z,{className:"w-6 h-6 text-primary-600 mt-1"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-primary-900 mb-1",children:"Phone Number Setup"}),(0,a.jsx)("p",{className:"text-sm text-primary-700 mb-3",children:"We'll automatically acquire a US phone number for your agent and configure it for inbound calls. For outbound calling, you'll add contacts in the CRM section."}),(0,a.jsx)("div",{className:"text-xs text-primary-600",children:"• Instant setup • US numbers only • Inbound calls ready immediately"})]})]})})]},"step4");default:return null}})()}),(0,a.jsxs)("div",{className:"flex justify-between mt-8",children:[(0,a.jsxs)("button",{onClick:()=>{l>1?i(l-1):s()},className:"btn-secondary flex items-center",children:[(0,a.jsx)(A.Z,{className:"w-4 h-4 mr-2"}),"Back"]}),l<4?(0,a.jsxs)("button",{onClick:()=>{j(l)&&i(l+1)},className:"btn-primary flex items-center",children:["Continue",(0,a.jsx)(q.Z,{className:"w-4 h-4 ml-2"})]}):(0,a.jsx)("button",{onClick:f,disabled:r,className:"btn-primary flex items-center",children:r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(W.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating Agent..."]}):(0,a.jsxs)(a.Fragment,{children:["Launch Agent",(0,a.jsx)(q.Z,{className:"w-4 h-4 ml-2"})]})})]})]})})}var G=s(99637),K=s(98728),H=s(32489),X=s(98617),Q=s(47692),$=s(58293);function ee(e){let{currentPath:t,onNavigate:s}=e,[l,i]=(0,n.useState)(!1),{user:r,profile:c,organization:o,subscription:d,logout:m}=h(),u=[{id:"dashboard",label:"Dashboard",icon:G.Z,href:"/dashboard"},{id:"agents",label:"Voice Agents",icon:T.Z,href:"/agents"},{id:"contacts",label:"CRM",icon:O.Z,href:"/contacts"},{id:"calls",label:"Call History",icon:D.Z,href:"/calls"},{id:"reports",label:"Reports",icon:F.Z,href:"/reports"},{id:"settings",label:"Settings",icon:K.Z,href:"/settings"}],x=async()=>{await m(),i(!1)},j=()=>{var e,n;return(0,a.jsxs)("div",{className:"flex flex-col h-full bg-white border-r border-neutral-200",children:[(0,a.jsx)("div",{className:"p-6 border-b border-neutral-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-primary-600 rounded-xl flex items-center justify-center",children:(0,a.jsx)(M.Z,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-lg font-bold text-neutral-900",children:"Kai Agent"}),(0,a.jsx)("p",{className:"text-sm text-neutral-500",children:"AI Voice Platform"})]})]}),(0,a.jsx)("button",{onClick:()=>i(!1),className:"md:hidden p-2 rounded-lg hover:bg-neutral-100",children:(0,a.jsx)(H.Z,{className:"w-5 h-5 text-neutral-500"})})]})}),(0,a.jsx)("nav",{className:"flex-1 p-4 space-y-2",children:u.map(e=>{let n=t===e.href,l=e.icon;return(0,a.jsxs)("button",{onClick:()=>{s(e.href),i(!1)},className:"w-full flex items-center space-x-3 px-4 py-3 rounded-xl text-left transition-all duration-200 nav-link ".concat(n?"bg-primary-50 text-primary-700 border border-primary-200":"text-neutral-600 hover:bg-neutral-50 hover:text-neutral-900"),disabled:e.comingSoon,children:[(0,a.jsx)(l,{className:"w-5 h-5 ".concat(n?"text-primary-600":"text-neutral-500")}),(0,a.jsx)("span",{className:"flex-1",children:e.label}),e.badge&&(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-medium bg-primary-100 text-primary-700 rounded-full",children:e.badge}),e.comingSoon&&(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-medium bg-neutral-100 text-neutral-500 rounded-full",children:"Soon"})]},e.id)})}),d&&(0,a.jsx)("div",{className:"p-4 border-t border-neutral-200",children:(0,a.jsxs)("div",{className:"bg-neutral-50 rounded-xl p-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)(X.Z,{className:"w-4 h-4 text-warning-600"}),(0,a.jsxs)("span",{className:"text-sm font-medium text-neutral-900 capitalize",children:[d.status," Plan"]})]}),(0,a.jsxs)("div",{className:"space-y-1 text-xs text-neutral-600",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Minutes Used:"}),(0,a.jsxs)("span",{className:"font-medium",children:[d.minutes_used," / ",d.minutes_included]})]}),"trial"===d.status&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Trial Ends:"}),(0,a.jsx)("span",{className:"font-medium",children:new Date(d.trial_end_date).toLocaleDateString()})]})]}),"trial"===d.status&&(0,a.jsx)("button",{onClick:()=>s("/upgrade"),className:"w-full mt-2 px-3 py-2 bg-primary-600 text-white text-xs font-medium rounded-lg hover:bg-primary-700 transition-colors",children:"Upgrade Plan"})]})}),(0,a.jsxs)("div",{className:"p-4 border-t border-neutral-200",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-secondary-100 rounded-xl flex items-center justify-center",children:(0,a.jsxs)("span",{className:"text-sm font-medium text-secondary-700",children:[null==c?void 0:null===(e=c.first_name)||void 0===e?void 0:e[0],null==c?void 0:null===(n=c.last_name)||void 0===n?void 0:n[0]]})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-neutral-900 truncate",children:[null==c?void 0:c.first_name," ",null==c?void 0:c.last_name]}),(0,a.jsx)("p",{className:"text-xs text-neutral-500 truncate",children:null==o?void 0:o.name})]})]}),(0,a.jsxs)("button",{onClick:x,className:"w-full flex items-center space-x-2 px-3 py-2 text-sm text-neutral-600 hover:text-neutral-900 hover:bg-neutral-50 rounded-lg transition-colors",children:[(0,a.jsx)(Q.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Sign Out"})]})]})]})};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>i(!0),className:"md:hidden fixed top-4 left-4 z-50 p-2 bg-white rounded-lg shadow-soft border border-neutral-200",children:(0,a.jsx)($.Z,{className:"w-6 h-6 text-neutral-600"})}),(0,a.jsx)("div",{className:"hidden md:flex w-80 h-screen fixed left-0 top-0 z-40",children:(0,a.jsx)(j,{})}),(0,a.jsx)(g.M,{children:l&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"md:hidden fixed inset-0 bg-black bg-opacity-50 z-40",onClick:()=>i(!1)}),(0,a.jsx)(p.E.div,{initial:{x:-320},animate:{x:0},exit:{x:-320},transition:{type:"spring",damping:25,stiffness:200},className:"md:hidden fixed left-0 top-0 w-80 h-screen z-50",children:(0,a.jsx)(j,{})})]})})]})}function et(e){let{children:t,currentPath:s,onNavigate:n}=e;return(0,a.jsxs)("div",{className:"min-h-screen bg-neutral-50",children:[(0,a.jsx)(ee,{currentPath:s,onNavigate:n}),(0,a.jsx)("div",{className:"md:ml-80",children:(0,a.jsx)("main",{className:"p-4 md:p-8",children:t})})]})}var es=s(12194),ea=s(91723),en=s(22252),el=s(16524),ei=s(22839);function er(e){let{onNavigate:t}=e,{profile:s,subscription:l,agents:i,contacts:r}=h(),[o,u]=(0,n.useState)(null),[g,j]=(0,n.useState)([]),[f,b]=(0,n.useState)(!0);(0,n.useEffect)(()=>{(null==s?void 0:s.organization_id)&&N()},[s]);let N=async()=>{try{b(!0);let{data:e}=await c.rpc("get_organization_stats",{org_id:null==s?void 0:s.organization_id});if(e&&e.length>0){let t=e[0];u({totalCalls:t.total_calls||0,successfulCalls:t.successful_calls||0,totalMinutes:t.total_minutes||0,totalContacts:t.total_contacts||0,activeAgents:t.active_agents||0,minutesRemaining:t.minutes_remaining||0,callsToday:0,successRateToday:0})}let{data:t}=await c.from("calls").select("\n          id,\n          direction,\n          outcome,\n          duration_seconds,\n          started_at,\n          from_number,\n          to_number,\n          contacts (first_name, last_name),\n          agents (name)\n        ").eq("organization_id",null==s?void 0:s.organization_id).order("created_at",{ascending:!1}).limit(10);if(t){let e=t.map(e=>{let t=Array.isArray(e.contacts)?e.contacts[0]:e.contacts,s=Array.isArray(e.agents)?e.agents[0]:e.agents;return{id:e.id,contact_name:t?"".concat(t.first_name||""," ").concat(t.last_name||"").trim():"inbound"===e.direction?e.from_number:e.to_number,phone_number:"inbound"===e.direction?e.from_number:e.to_number,direction:e.direction,outcome:e.outcome,duration_seconds:e.duration_seconds,started_at:e.started_at,agent_name:(null==s?void 0:s.name)||"Unknown"}});j(e);let s=new Date().toDateString(),a=e.filter(e=>new Date(e.started_at).toDateString()===s),n=a.filter(e=>"success"===e.outcome).length;u(e=>e?{...e,callsToday:a.length,successRateToday:a.length>0?n/a.length*100:0}:null)}}catch(e){console.error("Error fetching dashboard data:",e)}finally{b(!1)}},y=[{title:"Total Calls",value:(null==o?void 0:o.totalCalls)||0,icon:es.Z,color:"primary",trend:(null==o?void 0:o.callsToday)?"+".concat(o.callsToday," today"):"No calls today"},{title:"Success Rate",value:o&&o.totalCalls>0?"".concat(Math.round(o.successfulCalls/o.totalCalls*100),"%"):"0%",icon:S.Z,color:"success",trend:"".concat(Math.round((null==o?void 0:o.successRateToday)||0),"% today")},{title:"Minutes Used",value:"".concat((null==o?void 0:o.totalMinutes)||0,"m"),icon:ea.Z,color:"warning",trend:"".concat((null==o?void 0:o.minutesRemaining)||0,"m remaining")},{title:"Contacts",value:(null==o?void 0:o.totalContacts)||0,icon:O.Z,color:"secondary",trend:"Total in CRM"}];return f?(0,a.jsx)("div",{className:"space-y-8",children:(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[1,2,3,4].map(e=>(0,a.jsxs)("div",{className:"card animate-pulse",children:[(0,a.jsx)("div",{className:"h-4 bg-neutral-200 rounded w-1/2 mb-4"}),(0,a.jsx)("div",{className:"h-8 bg-neutral-200 rounded w-1/3 mb-2"}),(0,a.jsx)("div",{className:"h-3 bg-neutral-200 rounded w-1/4"})]},e))})}):(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(p.E.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-3xl font-bold text-neutral-900 mb-2",children:["Welcome back, ",null==s?void 0:s.first_name,"! \uD83D\uDC4B"]}),(0,a.jsx)("p",{className:"text-neutral-600",children:"Here's what's happening with your AI voice agents today."})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:y.map((e,t)=>{let s=e.icon;return(0,a.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"card",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,a.jsx)("div",{className:"w-12 h-12 bg-".concat(e.color,"-100 rounded-xl flex items-center justify-center"),children:(0,a.jsx)(s,{className:"w-6 h-6 text-".concat(e.color,"-600")})})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-neutral-600 mb-1",children:e.title}),(0,a.jsx)("p",{className:"text-2xl font-bold text-neutral-900 mb-1",children:e.value}),(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:e.trend})]})]},e.title)})}),l&&(0,a.jsx)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"card ".concat("trial"===l.status?"border-warning-200 bg-warning-50":"border-success-200 bg-success-50"),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(en.Z,{className:"w-6 h-6 ".concat("trial"===l.status?"text-warning-600":"text-success-600")}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-medium text-neutral-900 capitalize",children:[l.status," Account"]}),(0,a.jsx)("p",{className:"text-sm text-neutral-600",children:"trial"===l.status?"Trial ends ".concat(new Date(l.trial_end_date).toLocaleDateString()):"Active subscription"})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-neutral-900",children:[l.minutes_used," / ",l.minutes_included," minutes"]}),(0,a.jsx)("div",{className:"w-32 h-2 bg-neutral-200 rounded-full mt-1",children:(0,a.jsx)("div",{className:"h-full rounded-full ".concat("trial"===l.status?"bg-warning-500":"bg-success-500"),style:{width:"".concat(Math.min(l.minutes_used/l.minutes_included*100,100),"%")}})})]})]})}),(0,a.jsxs)("div",{className:"grid lg:grid-cols-2 gap-8",children:[(0,a.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"card",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-neutral-900",children:"Recent Calls"}),(0,a.jsx)("button",{onClick:()=>t("/calls"),className:"text-sm text-primary-600 hover:text-primary-700 font-medium",children:"View All"})]}),g.length>0?(0,a.jsx)("div",{className:"space-y-4",children:g.slice(0,5).map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-4 p-3 hover:bg-neutral-50 rounded-lg transition-colors",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center ".concat("inbound"===e.direction?"bg-primary-100":"bg-secondary-100"),children:"inbound"===e.direction?(0,a.jsx)(el.Z,{className:"w-5 h-5 ".concat("inbound"===e.direction?"text-primary-600":"text-secondary-600")}):(0,a.jsx)(ei.Z,{className:"w-5 h-5 text-secondary-600"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"font-medium text-neutral-900 truncate",children:e.contact_name||e.phone_number}),(0,a.jsxs)("p",{className:"text-sm text-neutral-500",children:[e.agent_name," • ",m(e.duration_seconds)]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat(x(e.outcome)),children:e.outcome.replace("_"," ")}),(0,a.jsx)("p",{className:"text-xs text-neutral-500 mt-1",children:new Date(e.started_at).toLocaleTimeString()})]})]},e.id))}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(es.Z,{className:"w-12 h-12 text-neutral-300 mx-auto mb-3"}),(0,a.jsx)("p",{className:"text-neutral-500",children:"No calls yet"}),(0,a.jsx)("p",{className:"text-sm text-neutral-400",children:"Your call history will appear here"})]})]}),(0,a.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"card",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-neutral-900",children:"Your Agents"}),(0,a.jsx)("button",{onClick:()=>t("/agents"),className:"text-sm text-primary-600 hover:text-primary-700 font-medium",children:"Manage Agents"})]}),i.length>0?(0,a.jsx)("div",{className:"space-y-4",children:i.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-4 p-3 hover:bg-neutral-50 rounded-lg transition-colors",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-primary-100 rounded-xl flex items-center justify-center",children:(0,a.jsx)(T.Z,{className:"w-5 h-5 text-primary-600"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("p",{className:"font-medium text-neutral-900 truncate",children:e.name}),(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(e.is_active&&e.phone_number?"bg-success-500":"bg-neutral-400")})]}),(0,a.jsx)("div",{className:"text-sm text-neutral-500",children:e.phone_number?(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,a.jsx)(D.Z,{className:"w-3 h-3"}),(0,a.jsx)("span",{children:d(e.phone_number)})]}),(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{children:"Savannah"===e.voice_id?"Sandra":"Jackson"})]}):(0,a.jsx)("span",{className:"text-warning-600",children:"No phone number assigned"})})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat(e.is_active&&e.phone_number?"text-success-600 bg-success-50":"text-warning-600 bg-warning-50"),children:e.is_active&&e.phone_number?"Active":"Setup Required"}),(0,a.jsxs)("p",{className:"text-xs text-neutral-500 mt-1",children:[e.total_calls," calls",e.total_calls>0&&(0,a.jsxs)(a.Fragment,{children:[" • ",Math.round(e.successful_calls/e.total_calls*100),"% success"]})]})]})]},e.id))}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(T.Z,{className:"w-12 h-12 text-neutral-300 mx-auto mb-3"}),(0,a.jsx)("p",{className:"text-neutral-500",children:"No agents configured"}),(0,a.jsx)("button",{onClick:()=>t("/agents"),className:"text-sm text-primary-600 hover:text-primary-700 font-medium mt-2",children:"Create Your First Agent"})]})]})]}),(0,a.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7},className:"card",children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-neutral-900 mb-6",children:"Quick Actions"}),(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,a.jsxs)("button",{onClick:()=>t("/contacts"),className:"p-4 border border-neutral-200 rounded-xl hover:border-primary-300 hover:bg-primary-50 transition-all duration-200 text-left",children:[(0,a.jsx)(O.Z,{className:"w-6 h-6 text-primary-600 mb-2"}),(0,a.jsx)("h3",{className:"font-medium text-neutral-900 mb-1",children:"Import Contacts"}),(0,a.jsx)("p",{className:"text-sm text-neutral-600",children:"Add contacts to your CRM for outbound calling"})]}),(0,a.jsxs)("button",{onClick:()=>t("/agents"),className:"p-4 border border-neutral-200 rounded-xl hover:border-primary-300 hover:bg-primary-50 transition-all duration-200 text-left",children:[(0,a.jsx)(T.Z,{className:"w-6 h-6 text-primary-600 mb-2"}),(0,a.jsx)("h3",{className:"font-medium text-neutral-900 mb-1",children:"Create Agent"}),(0,a.jsx)("p",{className:"text-sm text-neutral-600",children:"Set up a new AI voice agent"})]}),(0,a.jsxs)("button",{onClick:()=>t("/reports"),className:"p-4 border border-neutral-200 rounded-xl hover:border-primary-300 hover:bg-primary-50 transition-all duration-200 text-left",children:[(0,a.jsx)(F.Z,{className:"w-6 h-6 text-primary-600 mb-2"}),(0,a.jsx)("h3",{className:"font-medium text-neutral-900 mb-1",children:"View Reports"}),(0,a.jsx)("p",{className:"text-sm text-neutral-600",children:"Analyze call performance and metrics"})]})]})]})]})}var ec=s(45131),eo=s(17689),ed=s(99397),em=s(73247),eu=s(31047),ex=s(2207),eh=s(18930);function ep(e){let{onNavigate:t}=e,{profile:s,contacts:l,setContacts:i,agents:r,fetchAgents:m}=h(),[u,x]=(0,n.useState)(!1),[j,f]=(0,n.useState)(""),[b,N]=(0,n.useState)("all"),[y,w]=(0,n.useState)(!1),[C,k]=(0,n.useState)(!1),[A,Z]=(0,n.useState)(!1),[E,P]=(0,n.useState)([]),[z,I]=(0,n.useState)(""),[T,F]=(0,n.useState)(!1),[M,R]=(0,n.useState)(null),[q,U]=(0,n.useState)({firstName:"",lastName:"",phoneNumber:"",email:"",company:""});(0,n.useEffect)(()=>{L(),m()},[s]);let L=async()=>{if(null==s?void 0:s.organization_id)try{x(!0);let{data:e}=await c.from("contacts").select("*").eq("organization_id",s.organization_id).order("created_at",{ascending:!1});i(e||[])}catch(e){console.error("Error fetching contacts:",e),v.ZP.error("Failed to load contacts")}finally{x(!1)}},B=async()=>{console.log("\uD83D\uDCE5 handleImportContacts called",{csvFile:!!M,importData:z.length});let e="";if(M)console.log("\uD83D\uDCC4 Processing CSV file:",M.name),e=await M.text();else if(z.trim())console.log("\uD83D\uDCDD Processing text input, length:",z.length),e=z;else{v.ZP.error("Please enter contact data or upload a CSV file");return}try{F(!0),console.log("\uD83D\uDCE4 Calling import-contacts API...");let t=await o("import-contacts",{method:"POST",body:JSON.stringify({contacts:e,defaultCountryCode:"+1",format:"auto"})});console.log("✅ Import result:",t),v.ZP.success("Successfully imported ".concat(t.summary.imported," contacts")),t.summary.duplicates>0&&(0,v.ZP)("".concat(t.summary.duplicates," duplicates skipped"),{icon:"⚠️"}),t.summary.invalid>0&&v.ZP.error("".concat(t.summary.invalid," invalid entries")),w(!1),I(""),R(null),await L()}catch(e){console.error("Error importing contacts:",e),v.ZP.error(e.message||"Failed to import contacts")}finally{F(!1)}},V=async()=>{if(console.log("\uD83D\uDC65 handleAddContact called",q),!q.phoneNumber.trim()){v.ZP.error("Phone number is required");return}try{console.log("\uD83D\uDCBE Inserting contact into database...");let{error:e}=await c.from("contacts").insert({organization_id:null==s?void 0:s.organization_id,first_name:q.firstName||null,last_name:q.lastName||null,phone_number:q.phoneNumber,email:q.email||null,company:q.company||null});if(e)throw console.error("❌ Database error:",e),e;console.log("✅ Contact added successfully"),v.ZP.success("Contact added successfully"),k(!1),U({firstName:"",lastName:"",phoneNumber:"",email:"",company:""}),await L()}catch(e){console.error("Error adding contact:",e),v.ZP.error(e.message||"Failed to add contact")}},J=async(e,t)=>{if(!t){P([e.id]),Z(!0);return}try{let s=r.find(e=>e.id===t);if(!s){v.ZP.error("Selected agent not found");return}if(!s.vapi_assistant_id){v.ZP.error("Agent is not properly configured");return}let a=await o("initiate-outbound-call",{method:"POST",body:JSON.stringify({assistantId:s.vapi_assistant_id,customerNumber:e.phone_number,contactId:e.id})});a.success?(v.ZP.success("Calling ".concat(e.first_name||e.phone_number,"...")),await L()):v.ZP.error(a.error||"Failed to initiate call")}catch(e){console.error("Error initiating outbound call:",e),v.ZP.error(e.message||"Failed to initiate call")}},W=async e=>{if(0===E.length){v.ZP.error("No contacts selected");return}try{if(!r.find(t=>t.id===e)){v.ZP.error("Selected agent not found");return}let t=E.map(t=>{let s=l.find(e=>e.id===t);if(s)return J(s,e)});await Promise.all(t),P([]),Z(!1),v.ZP.success("Initiated calls for ".concat(E.length," contacts"))}catch(e){console.error("Error with bulk calling:",e),v.ZP.error("Failed to initiate some calls")}},Y=l.filter(e=>{var t,s,a,n;let l=(null===(t=e.first_name)||void 0===t?void 0:t.toLowerCase().includes(j.toLowerCase()))||(null===(s=e.last_name)||void 0===s?void 0:s.toLowerCase().includes(j.toLowerCase()))||e.phone_number.includes(j)||(null===(a=e.email)||void 0===a?void 0:a.toLowerCase().includes(j.toLowerCase()))||(null===(n=e.company)||void 0===n?void 0:n.toLowerCase().includes(j.toLowerCase())),i="all"===b||"contacted"===b&&e.total_calls>0||"never_contacted"===b&&0===e.total_calls||"success"===b&&"success"===e.last_call_outcome||"pending"===b&&"in_progress"===e.last_call_outcome;return l&&i}),G=e=>{if(0===e.total_calls)return(0,a.jsx)(ea.Z,{className:"w-4 h-4 text-neutral-400"});switch(e.last_call_outcome){case"success":return(0,a.jsx)(S.Z,{className:"w-4 h-4 text-success-500"});case"failure":return(0,a.jsx)(ec.Z,{className:"w-4 h-4 text-error-500"});case"in_progress":return(0,a.jsx)(ea.Z,{className:"w-4 h-4 text-warning-500"});default:return(0,a.jsx)(ea.Z,{className:"w-4 h-4 text-neutral-400"})}},K=e=>{var t;if(0===e.total_calls)return"Never contacted";let s=e.last_outbound_call||e.last_inbound_call,a=s?new Date(s).toLocaleDateString():"Unknown";return"".concat((null===(t=e.last_call_outcome)||void 0===t?void 0:t.replace("_"," "))||"Unknown"," - ").concat(a)};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-neutral-900",children:"CRM"}),(0,a.jsx)("p",{className:"text-neutral-600 mt-1",children:"Manage your contacts and track communication history"})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsxs)("button",{onClick:()=>w(!0),className:"btn-secondary flex items-center",children:[(0,a.jsx)(eo.Z,{className:"w-4 h-4 mr-2"}),"Import Contacts"]}),(0,a.jsxs)("button",{onClick:()=>k(!0),className:"btn-primary flex items-center",children:[(0,a.jsx)(ed.Z,{className:"w-4 h-4 mr-2"}),"Add Contact"]})]})]}),(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[(0,a.jsx)("div",{className:"flex-1 max-w-md",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(em.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-neutral-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Search contacts...",value:j,onChange:e=>f(e.target.value),className:"input-field pl-10"})]})}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("select",{value:b,onChange:e=>N(e.target.value),className:"input-field",children:[(0,a.jsx)("option",{value:"all",children:"All Contacts"}),(0,a.jsx)("option",{value:"contacted",children:"Contacted"}),(0,a.jsx)("option",{value:"never_contacted",children:"Never Contacted"}),(0,a.jsx)("option",{value:"success",children:"Successful Calls"}),(0,a.jsx)("option",{value:"pending",children:"Pending Follow-up"})]}),(0,a.jsxs)("span",{className:"text-sm text-neutral-500",children:[Y.length," of ",l.length," contacts"]})]})]})}),(0,a.jsx)("div",{className:"card p-0 overflow-hidden",children:u?(0,a.jsxs)("div",{className:"p-8 text-center",children:[(0,a.jsx)("div",{className:"animate-spin w-8 h-8 border-4 border-primary-200 border-t-primary-600 rounded-full mx-auto"}),(0,a.jsx)("p",{className:"text-neutral-500 mt-2",children:"Loading contacts..."})]}):Y.length>0?(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left py-4 px-6 font-medium text-neutral-900",children:"Contact"}),(0,a.jsx)("th",{className:"text-left py-4 px-6 font-medium text-neutral-900",children:"Phone"}),(0,a.jsx)("th",{className:"text-left py-4 px-6 font-medium text-neutral-900",children:"Company"}),(0,a.jsx)("th",{className:"text-left py-4 px-6 font-medium text-neutral-900",children:"Last Contact"}),(0,a.jsx)("th",{className:"text-left py-4 px-6 font-medium text-neutral-900",children:"Status"}),(0,a.jsx)("th",{className:"text-left py-4 px-6 font-medium text-neutral-900",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-neutral-200",children:Y.map((e,t)=>{var s,n;return(0,a.jsxs)(p.E.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*t},className:"hover:bg-neutral-50 transition-colors",children:[(0,a.jsx)("td",{className:"py-4 px-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-primary-100 rounded-xl flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-sm font-medium text-primary-700",children:(null===(s=e.first_name)||void 0===s?void 0:s[0])||(null===(n=e.last_name)||void 0===n?void 0:n[0])||e.phone_number[0]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-neutral-900",children:e.first_name||e.last_name?"".concat(e.first_name||""," ").concat(e.last_name||"").trim():"Unknown"}),e.email&&(0,a.jsx)("p",{className:"text-sm text-neutral-500",children:e.email})]})]})}),(0,a.jsx)("td",{className:"py-4 px-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(D.Z,{className:"w-4 h-4 text-neutral-400"}),(0,a.jsx)("span",{className:"text-neutral-900",children:d(e.phone_number)})]})}),(0,a.jsx)("td",{className:"py-4 px-6",children:e.company?(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(_.Z,{className:"w-4 h-4 text-neutral-400"}),(0,a.jsx)("span",{className:"text-neutral-900",children:e.company})]}):(0,a.jsx)("span",{className:"text-neutral-400",children:"—"})}),(0,a.jsx)("td",{className:"py-4 px-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(eu.Z,{className:"w-4 h-4 text-neutral-400"}),(0,a.jsx)("span",{className:"text-sm text-neutral-600",children:e.last_outbound_call||e.last_inbound_call?new Date(e.last_outbound_call||e.last_inbound_call).toLocaleDateString():"Never"})]})}),(0,a.jsx)("td",{className:"py-4 px-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[G(e),(0,a.jsx)("span",{className:"text-sm text-neutral-600",children:K(e)})]})}),(0,a.jsx)("td",{className:"py-4 px-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>J(e),className:"p-2 text-neutral-400 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition-colors",title:"Call Contact",disabled:0===r.filter(e=>e.is_active&&e.phone_number).length,children:(0,a.jsx)(es.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{className:"p-2 text-neutral-400 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition-colors",title:"Edit Contact",children:(0,a.jsx)(ex.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{className:"p-2 text-neutral-400 hover:text-error-600 hover:bg-error-50 rounded-lg transition-colors",title:"Delete Contact",children:(0,a.jsx)(eh.Z,{className:"w-4 h-4"})})]})})]},e.id)})})]})}):(0,a.jsxs)("div",{className:"p-12 text-center",children:[(0,a.jsx)(O.Z,{className:"w-16 h-16 text-neutral-300 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-neutral-900 mb-2",children:j||"all"!==b?"No contacts found":"No contacts yet"}),(0,a.jsx)("p",{className:"text-neutral-600 mb-6",children:j||"all"!==b?"Try adjusting your search or filter criteria":"Import contacts or add them manually to get started"}),!j&&"all"===b&&(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-center space-y-2 sm:space-y-0 sm:space-x-3",children:[(0,a.jsxs)("button",{onClick:()=>w(!0),className:"btn-secondary flex items-center justify-center",children:[(0,a.jsx)(eo.Z,{className:"w-4 h-4 mr-2"}),"Import Contacts"]}),(0,a.jsxs)("button",{onClick:()=>k(!0),className:"btn-primary flex items-center justify-center",children:[(0,a.jsx)(ed.Z,{className:"w-4 h-4 mr-2"}),"Add Manually"]})]})]})}),(0,a.jsx)(g.M,{children:y&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)(p.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-neutral-900",children:"Import Contacts"}),(0,a.jsx)("button",{onClick:()=>w(!1),className:"p-2 hover:bg-neutral-100 rounded-lg transition-colors",children:"✕"})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-primary-50 border border-primary-200 rounded-xl p-4",children:[(0,a.jsx)("h3",{className:"font-medium text-primary-900 mb-2",children:"Supported Formats"}),(0,a.jsxs)("div",{className:"text-sm text-primary-700 space-y-1",children:[(0,a.jsxs)("p",{children:["• ",(0,a.jsx)("strong",{children:"Phone only:"})," One phone number per line"]}),(0,a.jsxs)("p",{children:["• ",(0,a.jsx)("strong",{children:"Name + Phone:"})," John Doe +1234567890"]}),(0,a.jsxs)("p",{children:["• ",(0,a.jsx)("strong",{children:"Comma separated:"})," John Doe, +1234567890, john@email.com, Company"]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Upload CSV File"}),(0,a.jsxs)("div",{className:"border-2 border-dashed border-neutral-300 rounded-xl p-6 text-center hover:border-primary-400 transition-colors",children:[(0,a.jsx)("input",{type:"file",accept:".csv,text/csv",onChange:e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];s&&("text/csv"===s.type||s.name.endsWith(".csv")?(R(s),I("")):v.ZP.error("Please select a CSV file"))},className:"hidden",id:"csv-upload"}),(0,a.jsxs)("label",{htmlFor:"csv-upload",className:"cursor-pointer",children:[(0,a.jsx)(eo.Z,{className:"w-8 h-8 text-neutral-400 mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-sm text-neutral-600",children:M?M.name:"Click to upload CSV file"}),(0,a.jsx)("p",{className:"text-xs text-neutral-500 mt-1",children:"Support for CSV files with headers: Name, Phone, Email, Company"})]})]})]}),(0,a.jsx)("div",{className:"flex items-center justify-center",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"h-px bg-neutral-300 flex-1 w-16"}),(0,a.jsx)("span",{className:"text-sm text-neutral-500",children:"OR"}),(0,a.jsx)("div",{className:"h-px bg-neutral-300 flex-1 w-16"})]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Paste contact data"}),(0,a.jsx)("textarea",{value:z,onChange:e=>{I(e.target.value),e.target.value.trim()&&R(null)},placeholder:"John Smith +1234567890\nJane Doe, +1987654321, jane@company.com, Acme Corp\n+1555123456\nMichael Johnson +1444555666",className:"input-field resize-none h-32",disabled:!!M}),(0,a.jsx)("p",{className:"text-xs text-neutral-500 mt-1",children:"Each contact should be on a separate line. Phone numbers will be automatically formatted."})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{console.log("\uD83D\uDEAB Import cancel clicked"),w(!1)},className:"btn-secondary",children:"Cancel"}),(0,a.jsx)("button",{type:"button",onClick:e=>{e.preventDefault(),console.log("\uD83D\uDE80 Import button clicked",{disabled:T||!z.trim()&&!M,importing:T,hasData:!!z.trim(),hasFile:!!M}),B()},disabled:T||!z.trim()&&!M,className:"btn-primary",children:T?"Importing...":"Import Contacts"})]})]})]})})}),(0,a.jsx)(g.M,{children:C&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)(p.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-neutral-900",children:"Add Contact"}),(0,a.jsx)("button",{onClick:()=>k(!1),className:"p-2 hover:bg-neutral-100 rounded-lg transition-colors",children:"✕"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"First Name"}),(0,a.jsx)("input",{type:"text",value:q.firstName,onChange:e=>U(t=>({...t,firstName:e.target.value})),className:"input-field",placeholder:"John"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Last Name"}),(0,a.jsx)("input",{type:"text",value:q.lastName,onChange:e=>U(t=>({...t,lastName:e.target.value})),className:"input-field",placeholder:"Doe"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Phone Number *"}),(0,a.jsx)("input",{type:"tel",value:q.phoneNumber,onChange:e=>U(t=>({...t,phoneNumber:e.target.value})),className:"input-field",placeholder:"+1 (555) 123-4567",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Email"}),(0,a.jsx)("input",{type:"email",value:q.email,onChange:e=>U(t=>({...t,email:e.target.value})),className:"input-field",placeholder:"john@company.com"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Company"}),(0,a.jsx)("input",{type:"text",value:q.company,onChange:e=>U(t=>({...t,company:e.target.value})),className:"input-field",placeholder:"Acme Corp"})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{console.log("\uD83D\uDEAB Cancel button clicked"),k(!1)},className:"btn-secondary",children:"Cancel"}),(0,a.jsx)("button",{type:"button",onClick:e=>{e.preventDefault(),console.log("\uD83D\uDE80 Add contact button clicked",{disabled:!q.phoneNumber.trim()}),V()},disabled:!q.phoneNumber.trim(),className:"btn-primary",children:"Add Contact"})]})]})]})})}),(0,a.jsx)(g.M,{children:A&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)(p.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-neutral-900",children:"Select Agent"}),(0,a.jsx)("button",{onClick:()=>Z(!1),className:"p-2 hover:bg-neutral-100 rounded-lg transition-colors",children:"✕"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("p",{className:"text-sm text-neutral-600",children:["Choose which agent will handle the outbound call",E.length>1?"s":""," to:"]}),(0,a.jsx)("div",{className:"bg-neutral-50 rounded-lg p-3",children:(0,a.jsx)("div",{className:"text-sm font-medium text-neutral-900",children:1===E.length?(()=>{let e=l.find(e=>e.id===E[0]);return e?"".concat(e.first_name||""," ").concat(e.last_name||"").trim()||e.phone_number:"Unknown contact"})():"".concat(E.length," selected contacts")})}),(0,a.jsx)("div",{className:"space-y-2",children:r.filter(e=>e.is_active&&e.phone_number).map(e=>(0,a.jsx)("button",{onClick:()=>{if(1===E.length){let t=l.find(e=>e.id===E[0]);t&&J(t,e.id)}else W(e.id);Z(!1)},className:"w-full text-left p-3 border border-neutral-200 rounded-lg hover:border-primary-300 hover:bg-primary-50 transition-colors",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-neutral-900",children:e.name}),(0,a.jsxs)("div",{className:"text-sm text-neutral-600",children:["Savannah"===e.voice_id?"Sandra (Savannah)":"Jackson (Elliot)"," • ",d(e.phone_number)]})]}),(0,a.jsx)(es.Z,{className:"w-5 h-5 text-primary-600"})]})},e.id))}),0===r.filter(e=>e.is_active&&e.phone_number).length&&(0,a.jsxs)("div",{className:"text-center py-6",children:[(0,a.jsx)(en.Z,{className:"w-12 h-12 text-warning-500 mx-auto mb-3"}),(0,a.jsx)("h3",{className:"font-medium text-neutral-900 mb-2",children:"No Active Agents"}),(0,a.jsx)("p",{className:"text-sm text-neutral-600 mb-4",children:"You need at least one active agent with a phone number to make outbound calls."}),(0,a.jsx)("button",{onClick:()=>t("/agents"),className:"btn-primary text-sm",children:"Manage Agents"})]}),(0,a.jsx)("div",{className:"flex justify-end space-x-3 pt-4",children:(0,a.jsx)("button",{onClick:()=>Z(!1),className:"btn-secondary",children:"Cancel"})})]})]})})})]})}var eg=s(95252),ej=s(92735),ef=s(70525),eb=s(47625),eN=s(77031),ey=s(56940),ev=s(97059),ew=s(62994),eC=s(8147),eD=s(31699),e_=s(75169),ek=s(3574),eS=s(20407);let eA=["#0ea5e9","#22c55e","#f59e0b","#ef4444","#8b5cf6"];function eZ(e){let{onNavigate:t}=e,{profile:s,subscription:l}=h(),[i,r]=(0,n.useState)(!0),[o,d]=(0,n.useState)("7d"),[x,g]=(0,n.useState)(null),[j,f]=(0,n.useState)([]),[b,N]=(0,n.useState)([]),[y,v]=(0,n.useState)([]);(0,n.useEffect)(()=>{(null==s?void 0:s.organization_id)&&w()},[s,o]);let w=async()=>{try{r(!0);let e=parseInt(o.replace("d","")),t=new Date;t.setDate(t.getDate()-e);let{data:a}=await c.from("calls").select("\n          id,\n          outcome,\n          duration_seconds,\n          cost_usd,\n          started_at,\n          agents!inner(name)\n        ").eq("organization_id",null==s?void 0:s.organization_id).gte("started_at",t.toISOString()).order("started_at",{ascending:!0});if(a){let e=a.length,t=a.filter(e=>"success"===e.outcome).length,s=Math.round(a.reduce((e,t)=>e+t.duration_seconds,0)/60),n=a.reduce((e,t)=>e+(t.cost_usd||0),0);g({totalCalls:e,successfulCalls:t,failedCalls:e-t,totalMinutes:s,averageDuration:e>0?Math.round(60*s/e):0,successRate:e>0?Math.round(t/e*100):0,costTotal:n,avgCostPerCall:e>0?n/e:0});let l=new Map;a.forEach(e=>{let t=new Date(e.started_at).toLocaleDateString(),s=l.get(t)||{date:t,calls:0,successful:0,minutes:0,cost:0};s.calls+=1,"success"===e.outcome&&(s.successful+=1),s.minutes+=Math.round(e.duration_seconds/60),s.cost+=e.cost_usd||0,l.set(t,s)}),f(Array.from(l.values()).slice(-7));let i=new Map;a.forEach(e=>{var t,s;let a=(null===(t=e.agents)||void 0===t?void 0:t.name)||(Array.isArray(e.agents)?null===(s=e.agents[0])||void 0===s?void 0:s.name:null)||"Unknown",n=i.get(a)||{agentName:a,totalCalls:0,successfulCalls:0,successRate:0,avgDuration:0};n.totalCalls+=1,"success"===e.outcome&&(n.successfulCalls+=1),n.avgDuration=(n.avgDuration*(n.totalCalls-1)+e.duration_seconds)/n.totalCalls,n.successRate=Math.round(n.successfulCalls/n.totalCalls*100),i.set(a,n)}),N(Array.from(i.values()));let r=new Map;a.forEach(e=>{let t=e.outcome||"unknown";r.set(t,(r.get(t)||0)+1)});let c=Array.from(r.entries()).map(t=>{let[s,a]=t;return{name:s.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase()),value:a,percentage:Math.round(a/e*100)}});v(c)}}catch(e){console.error("Error fetching reports data:",e)}finally{r(!1)}},C=[{title:"Total Calls",value:(null==x?void 0:x.totalCalls)||0,icon:es.Z,color:"primary",change:"+12% vs last period"},{title:"Success Rate",value:"".concat((null==x?void 0:x.successRate)||0,"%"),icon:B.Z,color:"success",change:"+5% vs last period"},{title:"Total Minutes",value:"".concat((null==x?void 0:x.totalMinutes)||0,"m"),icon:ea.Z,color:"warning",change:"".concat(((null==l?void 0:l.minutes_included)||0)-((null==l?void 0:l.minutes_used)||0),"m remaining")},{title:"Total Cost",value:u((null==x?void 0:x.costTotal)||0),icon:eg.Z,color:"secondary",change:"".concat(u((null==x?void 0:x.avgCostPerCall)||0)," avg per call")}];return i?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsx)("h1",{className:"text-3xl font-bold text-neutral-900",children:"Reports"})}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[1,2,3,4].map(e=>(0,a.jsxs)("div",{className:"card animate-pulse",children:[(0,a.jsx)("div",{className:"h-4 bg-neutral-200 rounded w-1/2 mb-4"}),(0,a.jsx)("div",{className:"h-8 bg-neutral-200 rounded w-1/3 mb-2"}),(0,a.jsx)("div",{className:"h-3 bg-neutral-200 rounded w-1/4"})]},e))})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-neutral-900",children:"Reports & Analytics"}),(0,a.jsx)("p",{className:"text-neutral-600 mt-1",children:"Track performance and analyze your AI voice agent metrics"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)("select",{value:o,onChange:e=>d(e.target.value),className:"input-field",children:[(0,a.jsx)("option",{value:"7d",children:"Last 7 days"}),(0,a.jsx)("option",{value:"30d",children:"Last 30 days"}),(0,a.jsx)("option",{value:"90d",children:"Last 90 days"})]}),(0,a.jsxs)("button",{className:"btn-secondary flex items-center",children:[(0,a.jsx)(ej.Z,{className:"w-4 h-4 mr-2"}),"Export"]})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:C.map((e,t)=>{let s=e.icon;return(0,a.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"card",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-".concat(e.color,"-100 rounded-xl flex items-center justify-center"),children:(0,a.jsx)(s,{className:"w-6 h-6 text-".concat(e.color,"-600")})}),(0,a.jsx)("div",{className:"text-right",children:(0,a.jsx)(ef.Z,{className:"w-4 h-4 text-success-500 mb-1"})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-neutral-600 mb-1",children:e.title}),(0,a.jsx)("p",{className:"text-2xl font-bold text-neutral-900 mb-1",children:e.value}),(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:e.change})]})]},e.title)})}),(0,a.jsxs)("div",{className:"grid lg:grid-cols-2 gap-6",children:[(0,a.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"card",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-neutral-900",children:"Daily Performance"}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-primary-500 rounded-full"}),(0,a.jsx)("span",{className:"text-neutral-600",children:"Total Calls"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-success-500 rounded-full"}),(0,a.jsx)("span",{className:"text-neutral-600",children:"Successful"})]})]})]}),(0,a.jsx)("div",{className:"h-64",children:(0,a.jsx)(eb.h,{width:"100%",height:"100%",children:(0,a.jsxs)(eN.v,{data:j,children:[(0,a.jsx)(ey.q,{strokeDasharray:"3 3",stroke:"#f3f4f6"}),(0,a.jsx)(ev.K,{dataKey:"date",stroke:"#6b7280",fontSize:12}),(0,a.jsx)(ew.B,{stroke:"#6b7280",fontSize:12}),(0,a.jsx)(eC.u,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1)"}}),(0,a.jsx)(eD.$,{dataKey:"calls",fill:"#0ea5e9",radius:[4,4,0,0]}),(0,a.jsx)(eD.$,{dataKey:"successful",fill:"#22c55e",radius:[4,4,0,0]})]})})})]}),(0,a.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"card",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,a.jsx)("h2",{className:"text-lg font-bold text-neutral-900",children:"Call Outcomes"})}),(0,a.jsx)("div",{className:"h-64",children:(0,a.jsx)(eb.h,{width:"100%",height:"100%",children:(0,a.jsxs)(e_.u,{children:[(0,a.jsx)(ek.b,{data:y,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{name:t,percentage:s}=e;return"".concat(t,": ").concat(s,"%")},outerRadius:80,fill:"#8884d8",dataKey:"value",children:y.map((e,t)=>(0,a.jsx)(eS.b,{fill:eA[t%eA.length]},"cell-".concat(t)))}),(0,a.jsx)(eC.u,{})]})})}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-4 mt-4",children:y.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:eA[t%eA.length]}}),(0,a.jsx)("span",{className:"text-sm text-neutral-600",children:e.name}),(0,a.jsx)("span",{className:"text-sm font-medium text-neutral-900",children:e.value})]},e.name))})]})]}),(0,a.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"card",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,a.jsx)("h2",{className:"text-lg font-bold text-neutral-900",children:"Agent Performance"})}),b.length>0?(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-neutral-50 border-b border-neutral-200",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium text-neutral-900",children:"Agent"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium text-neutral-900",children:"Total Calls"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium text-neutral-900",children:"Successful"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium text-neutral-900",children:"Success Rate"}),(0,a.jsx)("th",{className:"text-left py-3 px-4 font-medium text-neutral-900",children:"Avg Duration"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-neutral-200",children:b.map((e,t)=>(0,a.jsxs)("tr",{className:"hover:bg-neutral-50",children:[(0,a.jsx)("td",{className:"py-3 px-4 font-medium text-neutral-900",children:e.agentName}),(0,a.jsx)("td",{className:"py-3 px-4 text-neutral-600",children:e.totalCalls}),(0,a.jsx)("td",{className:"py-3 px-4 text-neutral-600",children:e.successfulCalls}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"flex-1 bg-neutral-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-success-500 h-2 rounded-full",style:{width:"".concat(e.successRate,"%")}})}),(0,a.jsxs)("span",{className:"text-sm font-medium text-neutral-900",children:[e.successRate,"%"]})]})}),(0,a.jsx)("td",{className:"py-3 px-4 text-neutral-600",children:m(Math.round(e.avgDuration))})]},e.agentName))})]})}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(F.Z,{className:"w-12 h-12 text-neutral-300 mx-auto mb-3"}),(0,a.jsx)("p",{className:"text-neutral-500",children:"No agent performance data available"}),(0,a.jsx)("p",{className:"text-sm text-neutral-400",children:"Data will appear after your agents make calls"})]})]}),(0,a.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7},className:"card",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,a.jsx)("h2",{className:"text-lg font-bold text-neutral-900",children:"Consumption Report"})}),(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-primary-600 mb-2",children:(null==l?void 0:l.minutes_used)||0}),(0,a.jsx)("p",{className:"text-sm text-neutral-600",children:"Minutes Used"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-success-600 mb-2",children:((null==l?void 0:l.minutes_included)||0)-((null==l?void 0:l.minutes_used)||0)}),(0,a.jsx)("p",{className:"text-sm text-neutral-600",children:"Minutes Remaining"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-neutral-900 mb-2",children:u((null==x?void 0:x.costTotal)||0)}),(0,a.jsx)("p",{className:"text-sm text-neutral-600",children:"Total Cost"})]})]}),l&&(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm text-neutral-600",children:"Usage Progress"}),(0,a.jsxs)("span",{className:"text-sm font-medium text-neutral-900",children:[Math.round(l.minutes_used/l.minutes_included*100),"%"]})]}),(0,a.jsx)("div",{className:"w-full bg-neutral-200 rounded-full h-3",children:(0,a.jsx)("div",{className:"h-3 rounded-full transition-all duration-300 ".concat(l.minutes_used/l.minutes_included>.8?"bg-error-500":l.minutes_used/l.minutes_included>.6?"bg-warning-500":"bg-success-500"),style:{width:"".concat(Math.min(l.minutes_used/l.minutes_included*100,100),"%")}})})]})]})]})}var eE=s(89227),eP=s(33276),ez=s(17684);function eI(e){let{onNavigate:t}=e,{profile:s,agents:l,setAgents:i}=h(),[r,o]=(0,n.useState)(!1),[m,u]=(0,n.useState)(null),[x,j]=(0,n.useState)(!1);(0,n.useEffect)(()=>{f()},[s]);let f=async()=>{if(null==s?void 0:s.organization_id)try{o(!0);let{data:e}=await c.from("agents").select("*").eq("organization_id",s.organization_id).order("created_at",{ascending:!1});i(e||[])}catch(e){console.error("Error fetching agents:",e),v.ZP.error("Failed to load agents")}finally{o(!1)}},b=async e=>{try{let t=!e.is_active,{error:s}=await c.from("agents").update({is_active:t}).eq("id",e.id);if(s)throw s;await f(),v.ZP.success("Agent ".concat(t?"activated":"deactivated"))}catch(e){console.error("Error toggling agent status:",e),v.ZP.error("Failed to update agent status")}},N=e=>{navigator.clipboard.writeText(e),v.ZP.success("Phone number copied to clipboard")},y=e=>e.phone_number?e.is_active?(0,a.jsx)(S.Z,{className:"w-5 h-5 text-success-500"}):(0,a.jsx)(ec.Z,{className:"w-5 h-5 text-neutral-400"}):(0,a.jsx)(en.Z,{className:"w-5 h-5 text-warning-500"}),w=e=>e.phone_number?e.is_active?"Active":"Inactive":"No Phone Number",C=e=>0===e.total_calls?0:Math.round(e.successful_calls/e.total_calls*100),_=e=>({Savannah:"Sandra (Savannah)",Elliot:"Jackson (Elliot)"})[e]||e;return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-neutral-900",children:"Voice Agents"}),(0,a.jsx)("p",{className:"text-neutral-600 mt-1",children:"Manage your AI voice agents and monitor their performance"})]}),(0,a.jsxs)("button",{onClick:()=>t("/dashboard"),className:"btn-primary flex items-center",children:[(0,a.jsx)(ed.Z,{className:"w-4 h-4 mr-2"}),"Create New Agent"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-600",children:"Total Agents"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-neutral-900",children:l.length})]}),(0,a.jsx)(T.Z,{className:"w-8 h-8 text-primary-600"})]})}),(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-600",children:"Active Agents"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-success-600",children:l.filter(e=>e.is_active&&e.phone_number).length})]}),(0,a.jsx)(S.Z,{className:"w-8 h-8 text-success-600"})]})}),(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-600",children:"Total Calls"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-neutral-900",children:l.reduce((e,t)=>e+t.total_calls,0)})]}),(0,a.jsx)(es.Z,{className:"w-8 h-8 text-primary-600"})]})}),(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-neutral-600",children:"Success Rate"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-success-600",children:[l.length>0&&Math.round(l.reduce((e,t)=>e+t.successful_calls,0)/l.reduce((e,t)=>e+t.total_calls,0)*100)||0,"%"]})]}),(0,a.jsx)(ef.Z,{className:"w-8 h-8 text-success-600"})]})})]}),(0,a.jsx)("div",{className:"space-y-4",children:r?(0,a.jsxs)("div",{className:"card p-8 text-center",children:[(0,a.jsx)("div",{className:"animate-spin w-8 h-8 border-4 border-primary-200 border-t-primary-600 rounded-full mx-auto"}),(0,a.jsx)("p",{className:"text-neutral-500 mt-2",children:"Loading agents..."})]}):l.length>0?l.map((e,t)=>(0,a.jsxs)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"card hover:shadow-lg transition-all duration-200",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-primary-100 rounded-xl flex items-center justify-center",children:(0,a.jsx)(T.Z,{className:"w-6 h-6 text-primary-700"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900",children:e.name}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[y(e),(0,a.jsx)("span",{className:"text-sm font-medium ".concat(e.phone_number?e.is_active?"text-success-600":"text-neutral-400":"text-warning-600"),children:w(e)})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-6 mt-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(D.Z,{className:"w-4 h-4 text-neutral-400"}),e.phone_number?(0,a.jsx)("button",{onClick:()=>N(e.phone_number),className:"text-sm text-neutral-600 hover:text-primary-600 transition-colors",title:"Click to copy",children:d(e.phone_number)}):(0,a.jsx)("span",{className:"text-sm text-neutral-400",children:"No phone number"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(O.Z,{className:"w-4 h-4 text-neutral-400"}),(0,a.jsx)("span",{className:"text-sm text-neutral-600",children:_(e.voice_id)})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(es.Z,{className:"w-4 h-4 text-neutral-400"}),(0,a.jsxs)("span",{className:"text-sm text-neutral-600",children:[e.total_calls," calls"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(ef.Z,{className:"w-4 h-4 text-neutral-400"}),(0,a.jsxs)("span",{className:"text-sm text-neutral-600",children:[C(e),"% success"]})]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[e.phone_number&&(0,a.jsx)("button",{onClick:()=>b(e),className:"p-2 rounded-lg transition-colors ".concat(e.is_active?"text-warning-600 hover:bg-warning-50":"text-success-600 hover:bg-success-50"),title:e.is_active?"Deactivate Agent":"Activate Agent",children:e.is_active?(0,a.jsx)(eE.Z,{className:"w-4 h-4"}):(0,a.jsx)(eP.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>{u(e),j(!0)},className:"p-2 text-neutral-400 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition-colors",title:"View Details",children:(0,a.jsx)(K.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{className:"p-2 text-neutral-400 hover:text-neutral-600 hover:bg-neutral-50 rounded-lg transition-colors",title:"More Options",children:(0,a.jsx)(ez.Z,{className:"w-4 h-4"})})]})]}),e.business_objective&&(0,a.jsx)("div",{className:"mt-4 pt-4 border-t border-neutral-200",children:(0,a.jsxs)("p",{className:"text-sm text-neutral-600 line-clamp-2",children:[(0,a.jsx)("strong",{children:"Objective:"})," ",e.business_objective]})})]},e.id)):(0,a.jsxs)("div",{className:"card p-12 text-center",children:[(0,a.jsx)(T.Z,{className:"w-16 h-16 text-neutral-300 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-neutral-900 mb-2",children:"No agents configured yet"}),(0,a.jsx)("p",{className:"text-neutral-600 mb-6",children:"Create your first AI voice agent to start handling calls automatically"}),(0,a.jsxs)("button",{onClick:()=>t("/dashboard"),className:"btn-primary flex items-center mx-auto",children:[(0,a.jsx)(ed.Z,{className:"w-4 h-4 mr-2"}),"Create Your First Agent"]})]})}),(0,a.jsx)(g.M,{children:x&&m&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)(p.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-neutral-900",children:"Agent Details"}),(0,a.jsx)("button",{onClick:()=>j(!1),className:"p-2 hover:bg-neutral-100 rounded-lg transition-colors",children:"✕"})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Agent Name"}),(0,a.jsx)("p",{className:"text-neutral-900 font-medium",children:m.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Voice"}),(0,a.jsx)("p",{className:"text-neutral-900",children:_(m.voice_id)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Phone Number"}),(0,a.jsx)("p",{className:"text-neutral-900",children:m.phone_number?d(m.phone_number):"Not assigned"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-1",children:"Status"}),(0,a.jsx)("p",{className:"font-medium ".concat(m.phone_number?m.is_active?"text-success-600":"text-neutral-400":"text-warning-600"),children:w(m)})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-primary-600",children:m.total_calls}),(0,a.jsx)("p",{className:"text-sm text-neutral-600",children:"Total Calls"})]})}),(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("p",{className:"text-2xl font-bold text-success-600",children:[C(m),"%"]}),(0,a.jsx)("p",{className:"text-sm text-neutral-600",children:"Success Rate"})]})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Business Objective"}),(0,a.jsx)("p",{className:"text-neutral-900 text-sm bg-neutral-50 p-3 rounded-lg",children:m.business_objective||"Not specified"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Target Audience"}),(0,a.jsx)("p",{className:"text-neutral-900 text-sm bg-neutral-50 p-3 rounded-lg",children:m.target_audience||"Not specified"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Value Proposition"}),(0,a.jsx)("p",{className:"text-neutral-900 text-sm bg-neutral-50 p-3 rounded-lg",children:m.value_proposition||"Not specified"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,a.jsx)("button",{onClick:()=>j(!1),className:"btn-secondary",children:"Close"}),(0,a.jsxs)("button",{className:"btn-primary flex items-center",disabled:!0,children:[(0,a.jsx)(ex.Z,{className:"w-4 h-4 mr-2"}),"Edit Agent (Coming Soon)"]})]})]})]})})})]})}function eT(){let[e,t]=(0,n.useState)("loading"),[s,l]=(0,n.useState)(!1),[i,r]=(0,n.useState)(!1),[o,d]=(0,n.useState)(0),[m,u]=(0,n.useState)(!1),{user:x,profile:f,organization:b,agents:N,loading:y,setLoading:v,fetchUserData:w,fetchAgents:C}=h(),D=(0,n.useCallback)(()=>(console.log("\uD83C\uDFAF Determining view:",{loading:y,user:!!x,profile:!!f,onboardingCompleted:null==f?void 0:f.onboarding_completed,organization:!!b,agentsCount:N.length,authCompleted:i,isNavigating:s,initializationComplete:m}),s)?(console.log("\uD83D\uDD04 Navigation in progress, waiting..."),null):m?y&&x?(console.log("\uD83D\uDCCA User data still loading, staying on loading"),"loading"):x?f&&b?f.onboarding_completed?0===N.length?(console.log("\uD83E\uDD16 Onboarding complete but no agents, showing agent-setup"),"agent-setup"):(console.log("\uD83D\uDCCA Everything ready, showing dashboard"),"dashboard"):N.length>0?(console.log("\uD83D\uDD27 User has agents but onboarding not marked complete, fixing..."),c.from("user_profiles").update({onboarding_completed:!0}).eq("id",x.id).then(()=>{console.log("✅ Fixed onboarding status"),w()}),"dashboard"):(console.log("\uD83E\uDD16 Onboarding not complete, no agents, showing welcome"),"welcome"):(console.log("\uD83D\uDC4B No profile or organization, showing welcome"),"welcome"):(console.log("\uD83D\uDD10 No user found, showing auth"),"auth"):(console.log("⏳ Initialization not complete, staying on loading"),"loading"),[y,x,f,b,N.length,i,s,m,w]);(0,n.useEffect)(()=>{(async()=>{try{console.log("\uD83D\uDE80 Initializing app...");let{data:{session:e},error:s}=await c.auth.getSession();if(s){console.error("❌ Session error:",s),v(!1),u(!0),t("auth");return}if(console.log("\uD83D\uDCCB Session check result:",{session:!!e,user:!!(null==e?void 0:e.user)}),null==e?void 0:e.user){console.log("\uD83D\uDC64 User found, fetching user data..."),l(!0);try{await w(),console.log("✅ User data fetch completed"),r(!0)}catch(e){console.error("❌ Error fetching user data:",e),r(!0)}finally{l(!1),u(!0)}}else console.log("\uD83D\uDD10 No session, showing auth"),v(!1),u(!0),t("auth")}catch(e){console.error("\uD83D\uDCA5 App initialization error:",e),v(!1),u(!0),t("auth"),l(!1)}})();let{data:{subscription:e}}=c.auth.onAuthStateChange(async(e,s)=>{if(console.log("\uD83D\uDD10 Auth state change:",{event:e,hasUser:!!(null==s?void 0:s.user)}),"SIGNED_IN"===e&&(null==s?void 0:s.user)){console.log("\uD83D\uDE80 User signed in, processing..."),l(!0),r(!1),u(!1);try{await w(),r(!0),console.log("✅ Data fetched successfully after sign in")}catch(e){console.error("❌ Error fetching data after sign in:",e),r(!0)}finally{l(!1),u(!0)}}else"SIGNED_OUT"===e&&(console.log("\uD83D\uDE92 User signed out"),r(!1),l(!1),u(!0),v(!1),t("auth"))});return()=>e.unsubscribe()},[w,v]),(0,n.useEffect)(()=>{if(Date.now()-o<1e3){console.log("⏸️ Skipping automatic view determination due to recent manual navigation");return}let s=D();s&&s!==e&&(console.log("\uD83E\uDDED Auto-navigating from ".concat(e," to ").concat(s)),t(s))},[D,e,o]),(0,n.useEffect)(()=>{let a=setTimeout(()=>{if("loading"===e&&m&&!s){console.log("⚠️ Loading timeout reached after initialization, forcing view determination");let e=D();e&&"loading"!==e?(console.log("\uD83D\uDE91 Emergency navigation from loading to ".concat(e)),t(e)):(console.log("\uD83D\uDEA8 Emergency fallback to auth view"),t("auth"))}},8e3);return()=>clearTimeout(a)},[e,m,s,D]);let _=async()=>{console.log("\uD83C\uDF89 Auth success callback triggered"),l(!0),r(!1),u(!1);try{await w(),r(!0),console.log("✅ AuthSuccess fetchUserData completed")}catch(e){console.error("❌ AuthSuccess fetchUserData failed:",e),r(!0)}finally{l(!1),u(!0)}},k=()=>{console.log("\uD83C\uDF86 handleGetStarted called, switching to agent-setup"),t("agent-setup"),d(Date.now())},S=async()=>{console.log("\uD83C\uDF89 Agent setup completed, refreshing data..."),l(!0);try{await w(),console.log("✅ Data refreshed after agent setup"),t("dashboard"),d(Date.now())}catch(e){console.error("❌ Error refreshing data after agent setup:",e),t("dashboard"),d(Date.now())}finally{l(!1)}},A=(0,n.useCallback)(s=>{console.log("\uD83E\uDDED Navigation requested:",{path:s,currentView:e,timestamp:Date.now()});let a={"/dashboard":"dashboard","/agents":"agents","/contacts":"contacts","/calls":"calls","/reports":"reports","/settings":"settings"}[s]||"dashboard";if(a===e){console.log("\uD83D\uDCCD Already on requested view:",a);return}console.log("\uD83D\uDE80 Navigating from ".concat(e," to ").concat(a," (path: ").concat(s,")")),d(Date.now()),requestAnimationFrame(()=>{t(a),console.log("✅ Navigation completed to:",a)})},[e]),Z=!m||s||"loading"===e&&m;return(0,a.jsx)(g.M,{mode:"wait",children:(0,a.jsx)(p.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:(()=>{if(console.log("\uD83C\uDFA8 Rendering view:",{currentView:e,shouldShowLoading:Z,initializationComplete:m,isNavigating:s}),Z)return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-secondary-50 flex items-center justify-center",children:(0,a.jsxs)(p.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center",children:[(0,a.jsx)(j.Z,{className:"w-12 h-12 text-primary-600 animate-spin mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-bold text-neutral-900 mb-2",children:"Loading Kai Agent"}),(0,a.jsx)("p",{className:"text-neutral-600",children:m?s?"Processing authentication...":"Setting up your workspace...":"Initializing your AI voice platform..."})]})});switch(e){case"auth":return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-secondary-50 flex items-center justify-center p-4",children:(0,a.jsx)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-md",children:(0,a.jsx)(I,{onAuthSuccess:_})})});case"welcome":return(0,a.jsx)(L,{onGetStarted:k});case"agent-setup":return(0,a.jsx)(Y,{onComplete:S,onBack:()=>{t("welcome"),d(Date.now())}});case"dashboard":return(0,a.jsx)(et,{currentPath:"/dashboard",onNavigate:A,children:(0,a.jsx)(er,{onNavigate:A})});case"contacts":return(0,a.jsx)(et,{currentPath:"/contacts",onNavigate:A,children:(0,a.jsx)(ep,{onNavigate:A})});case"reports":return(0,a.jsx)(et,{currentPath:"/reports",onNavigate:A,children:(0,a.jsx)(eZ,{onNavigate:A})});case"agents":return(0,a.jsx)(et,{currentPath:"/agents",onNavigate:A,children:(0,a.jsx)(eI,{onNavigate:A})});case"calls":return(0,a.jsx)(et,{currentPath:"/calls",onNavigate:A,children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-neutral-900",children:"Call History"}),(0,a.jsx)("p",{className:"text-neutral-600 mt-1",children:"View and analyze your call data"})]}),(0,a.jsxs)("div",{className:"card text-center py-12",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 mb-2",children:"Call History"}),(0,a.jsx)("p",{className:"text-neutral-600 mb-4",children:"Detailed call history and analytics coming soon"}),(0,a.jsx)("button",{onClick:()=>A("/dashboard"),className:"btn-primary",children:"Back to Dashboard"})]})]})});case"settings":return(0,a.jsx)(et,{currentPath:"/settings",onNavigate:A,children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-neutral-900",children:"Settings"}),(0,a.jsx)("p",{className:"text-neutral-600 mt-1",children:"Manage your account and preferences"})]}),(0,a.jsxs)("div",{className:"card text-center py-12",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-neutral-900 mb-2",children:"Settings Panel"}),(0,a.jsx)("p",{className:"text-neutral-600 mb-4",children:"Account settings and preferences coming soon"}),(0,a.jsx)("button",{onClick:()=>A("/dashboard"),className:"btn-primary",children:"Back to Dashboard"})]})]})});default:return(0,a.jsx)("div",{className:"min-h-screen bg-neutral-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-neutral-900 mb-2",children:"Page Not Found"}),(0,a.jsx)("p",{className:"text-neutral-600 mb-4",children:"The page you're looking for doesn't exist."}),(0,a.jsx)("button",{onClick:()=>A("/dashboard"),className:"btn-primary",children:"Go to Dashboard"})]})})}})()},e)})}}},function(e){e.O(0,[216,744],function(){return e(e.s=39107)}),_N_E=e.O()}]);